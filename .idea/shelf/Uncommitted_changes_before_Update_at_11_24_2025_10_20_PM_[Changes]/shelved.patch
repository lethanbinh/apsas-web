Index: src/app/admin/dashboard/components/AcademicTab.tsx
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\"use client\";\r\n\r\nimport React, { useEffect, useState, useMemo } from \"react\";\r\nimport { Card, Row, Col, Statistic, Table, Tag, Typography, Space, Input, Select, DatePicker, Button, App } from \"antd\";\r\nimport {\r\n  BookOutlined,\r\n  CalendarOutlined,\r\n  TeamOutlined,\r\n  UserOutlined,\r\n  FileTextOutlined,\r\n  SearchOutlined,\r\n  FilterOutlined,\r\n  FileExcelOutlined,\r\n  GlobalOutlined,\r\n  SolutionOutlined,\r\n  WarningOutlined,\r\n  BarChartOutlined,\r\n  UsergroupAddOutlined,\r\n} from \"@ant-design/icons\";\r\nimport { Dayjs } from \"dayjs\";\r\nimport * as XLSX from \"xlsx\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip as RechartsTooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\nimport { adminService } from \"@/services/adminService\";\r\nimport { classService } from \"@/services/classService\";\r\nimport type { DashboardOverview, ChartData } from \"@/services/adminDashboardService\";\r\nimport { Semester } from \"@/types\";\r\nimport dayjs from \"dayjs\";\r\n\r\nconst { Title, Text } = Typography;\r\nconst { Search } = Input;\r\nconst { RangePicker } = DatePicker;\r\n\r\nconst COLORS = {\r\n  blue: \"#2563EB\",\r\n  green: \"#10B981\",\r\n  purple: \"#6D28D9\",\r\n  orange: \"#F59E0B\",\r\n  red: \"#EF4444\",\r\n  cyan: \"#06B6D4\",\r\n};\r\n\r\ninterface AcademicTabProps {\r\n  overview: DashboardOverview | null;\r\n  chartData: ChartData | null;\r\n  loading: boolean;\r\n  onRefresh: () => void;\r\n}\r\n\r\nconst AcademicTab: React.FC<AcademicTabProps> = ({\r\n  overview,\r\n  chartData,\r\n  loading,\r\n}) => {\r\n  const { message } = App.useApp();\r\n  const [semesters, setSemesters] = useState<Semester[]>([]);\r\n  const [classes, setClasses] = useState<any[]>([]);\r\n  const [semestersLoading, setSemestersLoading] = useState(false);\r\n  const [exportLoading, setExportLoading] = useState(false);\r\n\r\n  const handleExportExcel = () => {\r\n    if (!overview) {\r\n      message.warning(\"No data available to export\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setExportLoading(true);\r\n      const wb = XLSX.utils.book_new();\r\n\r\n      // All Statistics Cards Sheet (6 cards)\r\n      const statsData = [\r\n        [\"Metric\", \"Value\"],\r\n        [\"Total Semesters\", overview.academic.totalSemesters],\r\n        [\"Active Semesters\", overview.academic.activeSemesters],\r\n        [\"Total Classes\", overview.academic.totalClasses],\r\n        [\"Classes Without Students\", overview.academic.classesWithoutStudents || 0],\r\n        [\"Average Students Per Class\", overview.academic.averageStudentsPerClass?.toFixed(1) || 0],\r\n        [\"Semester Courses\", overview.academic.semesterCourses || 0],\r\n        [\"Total Course Elements\", overview.academic.totalCourseElements || 0],\r\n        [\"Total Students (All Classes)\", classes.reduce((sum, cls) => sum + (parseInt(cls.studentCount || \"0\", 10) || 0), 0)],\r\n      ];\r\n      const ws1 = XLSX.utils.aoa_to_sheet(statsData);\r\n      XLSX.utils.book_append_sheet(wb, ws1, \"Statistics\");\r\n\r\n      // Semester Activity Chart Data (Bar Chart)\r\n      if (chartData?.semesterActivity && chartData.semesterActivity.length > 0) {\r\n        const semesterActivitySheet = chartData.semesterActivity.map((item: any) => ({\r\n          Semester: item.semester,\r\n          Classes: item.classes,\r\n          Courses: item.courses,\r\n          Assessments: item.assessments,\r\n          Submissions: item.submissions,\r\n        }));\r\n        const ws2 = XLSX.utils.json_to_sheet(semesterActivitySheet);\r\n        XLSX.utils.book_append_sheet(wb, ws2, \"Semester Activity\");\r\n      }\r\n\r\n      // Classes by Semester Chart Data (Line Chart)\r\n      if (overview.academic.classesBySemester && overview.academic.classesBySemester.length > 0) {\r\n        const classesBySemSheet = overview.academic.classesBySemester.map((item: any) => ({\r\n          \"Semester Code\": item.semesterCode,\r\n          \"Class Count\": item.classCount,\r\n          \"Student Count\": item.studentCount,\r\n        }));\r\n        const ws3 = XLSX.utils.json_to_sheet(classesBySemSheet);\r\n        XLSX.utils.book_append_sheet(wb, ws3, \"Classes by Semester\");\r\n      }\r\n\r\n      // All Semesters Table (Filtered)\r\n      const semestersData = filteredSemesters.map((sem, index) => ({\r\n        \"No\": index + 1,\r\n        \"ID\": sem.id,\r\n        \"Semester Code\": sem.semesterCode,\r\n        \"Academic Year\": sem.academicYear,\r\n        \"Start Date\": dayjs(sem.startDate).format(\"YYYY-MM-DD\"),\r\n        \"End Date\": dayjs(sem.endDate).format(\"YYYY-MM-DD\"),\r\n        \"Note\": sem.note || \"\",\r\n        \"Status\": dayjs().isAfter(dayjs(sem.startDate)) && dayjs().isBefore(dayjs(sem.endDate)) ? \"Active\" : \"Inactive\",\r\n      }));\r\n      const ws4 = XLSX.utils.json_to_sheet(semestersData);\r\n      XLSX.utils.book_append_sheet(wb, ws4, \"All Semesters\");\r\n\r\n      // All Classes Table (Filtered)\r\n      const classesData = filteredClasses.map((cls, index) => ({\r\n        \"No\": index + 1,\r\n        \"ID\": cls.id,\r\n        \"Class Code\": cls.classCode || \"\",\r\n        \"Course Name\": cls.courseName || \"\",\r\n        \"Semester\": cls.semesterName || \"\",\r\n        \"Lecturer\": cls.lecturerName || \"\",\r\n        \"Students\": parseInt(cls.studentCount || \"0\", 10),\r\n      }));\r\n      const ws5 = XLSX.utils.json_to_sheet(classesData);\r\n      XLSX.utils.book_append_sheet(wb, ws5, \"All Classes\");\r\n\r\n      // Top Classes by Students\r\n      if (overview.academic.topClassesByStudents && overview.academic.topClassesByStudents.length > 0) {\r\n        const topClassesData = overview.academic.topClassesByStudents.map((item, index) => ({\r\n          \"Rank\": index + 1,\r\n          \"Class Code\": item.classCode,\r\n          \"Course Name\": item.courseName,\r\n          \"Lecturer\": item.lecturerName,\r\n          \"Students\": typeof item.studentCount === \"string\" ? parseInt(item.studentCount || \"0\", 10) : (item.studentCount || 0),\r\n        }));\r\n        const ws6 = XLSX.utils.json_to_sheet(topClassesData);\r\n        XLSX.utils.book_append_sheet(wb, ws6, \"Top Classes by Students\");\r\n      }\r\n\r\n      const fileName = `Academic_Dashboard_${dayjs().format(\"YYYY-MM-DD\")}.xlsx`;\r\n      XLSX.writeFile(wb, fileName);\r\n      message.success(\"Academic data exported successfully\");\r\n    } catch (error) {\r\n      console.error(\"Export error:\", error);\r\n      message.error(\"Failed to export academic data\");\r\n    } finally {\r\n      setExportLoading(false);\r\n    }\r\n  };\r\n  const [classesLoading, setClassesLoading] = useState(false);\r\n  const [semesterSearch, setSemesterSearch] = useState(\"\");\r\n  const [classSearch, setClassSearch] = useState(\"\");\r\n  const [selectedSemester, setSelectedSemester] = useState<string | undefined>(undefined);\r\n  const [semesterDateRange, setSemesterDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\r\n  const [classDateRange, setClassDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      setSemestersLoading(true);\r\n      setClassesLoading(true);\r\n      const [semestersData, classesData] = await Promise.all([\r\n        adminService.getPaginatedSemesters(1, 100),\r\n        classService.getClassList({ pageNumber: 1, pageSize: 1000 }),\r\n      ]);\r\n      setSemesters(semestersData);\r\n      setClasses(classesData.classes);\r\n    } catch (error) {\r\n      console.error(\"Error fetching academic data:\", error);\r\n    } finally {\r\n      setSemestersLoading(false);\r\n      setClassesLoading(false);\r\n    }\r\n  };\r\n\r\n  // Filter semesters\r\n  const filteredSemesters = useMemo(() => {\r\n    let filtered = [...semesters];\r\n\r\n    if (semesterSearch) {\r\n      const searchLower = semesterSearch.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (sem) =>\r\n          sem.semesterCode?.toLowerCase().includes(searchLower) ||\r\n          sem.note?.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    if (semesterDateRange && semesterDateRange[0] && semesterDateRange[1]) {\r\n      filtered = filtered.filter((sem) => {\r\n        const startDate = dayjs(sem.startDate);\r\n        const endDate = dayjs(sem.endDate);\r\n        const filterStart = semesterDateRange[0]!.startOf(\"day\");\r\n        const filterEnd = semesterDateRange[1]!.endOf(\"day\");\r\n        // Check if semester overlaps with date range\r\n        return (\r\n          (startDate.isBefore(filterEnd) || startDate.isSame(filterEnd)) &&\r\n          (endDate.isAfter(filterStart) || endDate.isSame(filterStart))\r\n        );\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [semesters, semesterSearch, semesterDateRange]);\r\n\r\n  // Filter classes\r\n  const filteredClasses = useMemo(() => {\r\n    let filtered = [...classes];\r\n\r\n    if (classSearch) {\r\n      const searchLower = classSearch.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (cls) =>\r\n          cls.classCode?.toLowerCase().includes(searchLower) ||\r\n          cls.courseName?.toLowerCase().includes(searchLower) ||\r\n          cls.lecturerName?.toLowerCase().includes(searchLower) ||\r\n          cls.semesterName?.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    if (selectedSemester) {\r\n      filtered = filtered.filter((cls) => cls.semesterName === selectedSemester);\r\n    }\r\n\r\n    if (classDateRange && classDateRange[0] && classDateRange[1]) {\r\n      filtered = filtered.filter((cls) => {\r\n        const createdAt = dayjs(cls.createdAt);\r\n        return (\r\n          createdAt.isAfter(classDateRange[0]!.subtract(1, \"day\")) &&\r\n          createdAt.isBefore(classDateRange[1]!.add(1, \"day\"))\r\n        );\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [classes, classSearch, selectedSemester, classDateRange]);\r\n\r\n  if (!overview) return null;\r\n\r\n  const semesterColumns = [\r\n    {\r\n      title: \"Semester Code\",\r\n      dataIndex: \"semesterCode\",\r\n      key: \"semesterCode\",\r\n    },\r\n    {\r\n      title: \"Academic Year\",\r\n      dataIndex: \"academicYear\",\r\n      key: \"academicYear\",\r\n    },\r\n    {\r\n      title: \"Start Date\",\r\n      dataIndex: \"startDate\",\r\n      key: \"startDate\",\r\n      render: (date: string) => dayjs(date).format(\"MMM DD, YYYY\"),\r\n    },\r\n    {\r\n      title: \"End Date\",\r\n      dataIndex: \"endDate\",\r\n      key: \"endDate\",\r\n      render: (date: string) => dayjs(date).format(\"MMM DD, YYYY\"),\r\n    },\r\n    {\r\n      title: \"Status\",\r\n      key: \"status\",\r\n      render: (_: any, record: Semester) => {\r\n        const now = new Date();\r\n        const startDate = new Date(record.startDate);\r\n        const endDate = new Date(record.endDate);\r\n        const isActive = now >= startDate && now <= endDate;\r\n        return (\r\n          <Tag color={isActive ? \"green\" : \"default\"}>\r\n            {isActive ? \"Active\" : \"Inactive\"}\r\n          </Tag>\r\n        );\r\n      },\r\n    },\r\n  ];\r\n\r\n  const classColumns = [\r\n    {\r\n      title: \"Class Code\",\r\n      dataIndex: \"classCode\",\r\n      key: \"classCode\",\r\n    },\r\n    {\r\n      title: \"Course Name\",\r\n      dataIndex: \"courseName\",\r\n      key: \"courseName\",\r\n    },\r\n    {\r\n      title: \"Semester\",\r\n      dataIndex: \"semesterName\",\r\n      key: \"semesterName\",\r\n    },\r\n    {\r\n      title: \"Lecturer\",\r\n      dataIndex: \"lecturerName\",\r\n      key: \"lecturerName\",\r\n    },\r\n    {\r\n      title: \"Students\",\r\n      dataIndex: \"studentCount\",\r\n      key: \"studentCount\",\r\n      render: (count: string) => parseInt(count) || 0,\r\n      sorter: (a: any, b: any) => (parseInt(a.studentCount) || 0) - (parseInt(b.studentCount) || 0),\r\n    },\r\n  ];\r\n\r\n  const semesterActivityData = chartData?.semesterActivity || [];\r\n  const classesBySemesterData = overview.academic.classesBySemester || [];\r\n\r\n  return (\r\n    <Space direction=\"vertical\" size=\"large\" style={{ width: \"100%\" }}>\r\n      {/* Export Button Header */}\r\n      <Card>\r\n        <Space style={{ width: \"100%\", justifyContent: \"space-between\" }}>\r\n          <Title level={4} style={{ margin: 0 }}>Academic Dashboard</Title>\r\n          <Button\r\n            icon={<FileExcelOutlined />}\r\n            onClick={handleExportExcel}\r\n            loading={exportLoading}\r\n            type=\"primary\"\r\n            size=\"large\"\r\n          >\r\n            Export All Data to Excel\r\n          </Button>\r\n        </Space>\r\n      </Card>\r\n\r\n      {/* Academic Statistics Overview */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Semester & Course Statistics</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Total Semesters\"\r\n                value={overview.academic.totalSemesters}\r\n                prefix={<CalendarOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Active Semesters\"\r\n                value={overview.academic.activeSemesters}\r\n                prefix={<CalendarOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Total Courses\"\r\n                value={overview.academic.totalCourses || 0}\r\n                prefix={<GlobalOutlined />}\r\n                valueStyle={{ color: COLORS.purple }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Course Elements\"\r\n                value={overview.academic.totalCourseElements || 0}\r\n                prefix={<FileTextOutlined />}\r\n                valueStyle={{ color: COLORS.cyan }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Class Statistics */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Class Statistics</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Total Classes\"\r\n                value={overview.academic.totalClasses}\r\n                prefix={<BookOutlined />}\r\n                valueStyle={{ color: COLORS.cyan }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Average Students/Class\"\r\n                value={overview.academic.averageStudentsPerClass || 0}\r\n                prefix={<BarChartOutlined />}\r\n                valueStyle={{ color: COLORS.orange }}\r\n                precision={1}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Classes Without Students\"\r\n                value={overview.academic.classesWithoutStudents || 0}\r\n                prefix={<WarningOutlined />}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Classes Overloaded (>50)\"\r\n                value={overview.academic.classesOverloaded || 0}\r\n                prefix={<WarningOutlined />}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* People Statistics */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>People Statistics</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Total Students\"\r\n                value={overview.academic.totalStudents || 0}\r\n                prefix={<UsergroupAddOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Total Lecturers\"\r\n                value={overview.academic.totalLecturers || 0}\r\n                prefix={<SolutionOutlined />}\r\n                valueStyle={{ color: COLORS.orange }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Student/Lecturer Ratio\"\r\n                value={overview.academic.studentToLecturerRatio || 0}\r\n                prefix={<TeamOutlined />}\r\n                valueStyle={{ color: COLORS.purple }}\r\n                precision={1}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Semester Courses\"\r\n                value={overview.academic.semesterCourses || 0}\r\n                prefix={<FileTextOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Charts */}\r\n      <Row gutter={[16, 16]}>\r\n        <Col xs={24} lg={12}>\r\n          <Card title=\"Semester Activity\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <BarChart data={semesterActivityData}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"semester\" />\r\n                <YAxis />\r\n                <RechartsTooltip />\r\n                <Legend />\r\n                <Bar dataKey=\"classes\" fill={COLORS.blue} name=\"Classes\" />\r\n                <Bar dataKey=\"courses\" fill={COLORS.green} name=\"Courses\" />\r\n                <Bar dataKey=\"assessments\" fill={COLORS.purple} name=\"Assessments\" />\r\n                <Bar dataKey=\"submissions\" fill={COLORS.orange} name=\"Submissions\" />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n\r\n        <Col xs={24} lg={12}>\r\n          <Card title=\"Classes by Semester\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <LineChart data={classesBySemesterData}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"semesterCode\" />\r\n                <YAxis />\r\n                <RechartsTooltip />\r\n                <Legend />\r\n                <Line\r\n                  type=\"monotone\"\r\n                  dataKey=\"classCount\"\r\n                  stroke={COLORS.blue}\r\n                  name=\"Classes\"\r\n                />\r\n                <Line\r\n                  type=\"monotone\"\r\n                  dataKey=\"studentCount\"\r\n                  stroke={COLORS.green}\r\n                  name=\"Students\"\r\n                />\r\n              </LineChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Top Classes */}\r\n      {overview.academic.topClassesByStudents && overview.academic.topClassesByStudents.length > 0 && (\r\n        <Card title=\"Top Classes by Student Count\">\r\n          <Table\r\n            columns={[\r\n              {\r\n                title: \"Class Code\",\r\n                dataIndex: \"classCode\",\r\n                key: \"classCode\",\r\n              },\r\n              {\r\n                title: \"Course Name\",\r\n                dataIndex: \"courseName\",\r\n                key: \"courseName\",\r\n              },\r\n              {\r\n                title: \"Lecturer\",\r\n                dataIndex: \"lecturerName\",\r\n                key: \"lecturerName\",\r\n              },\r\n              {\r\n                title: \"Students\",\r\n                dataIndex: \"studentCount\",\r\n                key: \"studentCount\",\r\n                render: (count: number) => (\r\n                  <Tag color=\"blue\">{count}</Tag>\r\n                ),\r\n              },\r\n            ]}\r\n            dataSource={overview.academic.topClassesByStudents}\r\n            rowKey=\"id\"\r\n            pagination={false}\r\n            size=\"small\"\r\n          />\r\n        </Card>\r\n      )}\r\n\r\n      {/* Semesters Table */}\r\n      <Card\r\n        title=\"All Semesters\"\r\n        loading={semestersLoading}\r\n        extra={\r\n          <Space>\r\n            <RangePicker\r\n              placeholder={[\"Start Date\", \"End Date\"]}\r\n              value={semesterDateRange}\r\n              onChange={(dates) => setSemesterDateRange(dates as [Dayjs | null, Dayjs | null] | null)}\r\n              style={{ width: 250 }}\r\n              allowClear\r\n            />\r\n          </Space>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: \"100%\", marginBottom: 16 }}>\r\n          <Search\r\n            placeholder=\"Search by semester code or note\"\r\n            allowClear\r\n            enterButton={<SearchOutlined />}\r\n            size=\"large\"\r\n            value={semesterSearch}\r\n            onChange={(e) => setSemesterSearch(e.target.value)}\r\n            onSearch={setSemesterSearch}\r\n          />\r\n          <Text type=\"secondary\">\r\n            Showing {filteredSemesters.length} of {semesters.length} semesters\r\n          </Text>\r\n        </Space>\r\n        <Table\r\n          columns={semesterColumns}\r\n          dataSource={filteredSemesters}\r\n          rowKey=\"id\"\r\n          pagination={{ pageSize: 10, showTotal: (total) => `Total ${total} semesters` }}\r\n        />\r\n      </Card>\r\n\r\n      {/* Classes Table */}\r\n      <Card\r\n        title=\"All Classes\"\r\n        loading={classesLoading}\r\n        extra={\r\n          <Space>\r\n            <Select\r\n              placeholder=\"Filter by Semester\"\r\n              allowClear\r\n              style={{ width: 200 }}\r\n              value={selectedSemester}\r\n              onChange={setSelectedSemester}\r\n              suffixIcon={<FilterOutlined />}\r\n            >\r\n              {semesters.map((sem) => (\r\n                <Select.Option key={sem.id} value={sem.semesterCode}>\r\n                  {sem.semesterCode}\r\n                </Select.Option>\r\n              ))}\r\n            </Select>\r\n            <RangePicker\r\n              placeholder={[\"Start Date\", \"End Date\"]}\r\n              value={classDateRange}\r\n              onChange={(dates) => setClassDateRange(dates as [Dayjs | null, Dayjs | null] | null)}\r\n              style={{ width: 250 }}\r\n              allowClear\r\n            />\r\n          </Space>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: \"100%\", marginBottom: 16 }}>\r\n          <Search\r\n            placeholder=\"Search by class code, course, lecturer, or semester\"\r\n            allowClear\r\n            enterButton={<SearchOutlined />}\r\n            size=\"large\"\r\n            value={classSearch}\r\n            onChange={(e) => setClassSearch(e.target.value)}\r\n            onSearch={setClassSearch}\r\n          />\r\n          <Text type=\"secondary\">\r\n            Showing {filteredClasses.length} of {classes.length} classes\r\n          </Text>\r\n        </Space>\r\n        <Table\r\n          columns={classColumns}\r\n          dataSource={filteredClasses}\r\n          rowKey=\"id\"\r\n          pagination={{ pageSize: 10, showTotal: (total) => `Total ${total} classes` }}\r\n          scroll={{ x: 800 }}\r\n        />\r\n      </Card>\r\n    </Space>\r\n  );\r\n};\r\n\r\nexport default AcademicTab;\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/app/admin/dashboard/components/AcademicTab.tsx b/src/app/admin/dashboard/components/AcademicTab.tsx
--- a/src/app/admin/dashboard/components/AcademicTab.tsx	(revision 6f9873a8330481f7416524ce2b29e489e3f5c3fa)
+++ b/src/app/admin/dashboard/components/AcademicTab.tsx	(date 1763996951158)
@@ -354,27 +354,27 @@
       {/* Academic Statistics Overview */}
       <Card>
         <Title level={5} style={{ marginBottom: 16 }}>Semester & Course Statistics</Title>
-        <Row gutter={[16, 16]}>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Total Semesters"
-                value={overview.academic.totalSemesters}
-                prefix={<CalendarOutlined />}
-                valueStyle={{ color: COLORS.blue }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Active Semesters"
-                value={overview.academic.activeSemesters}
-                prefix={<CalendarOutlined />}
-                valueStyle={{ color: COLORS.green }}
-              />
-            </Card>
-          </Col>
+      <Row gutter={[16, 16]}>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Total Semesters"
+              value={overview.academic.totalSemesters}
+              prefix={<CalendarOutlined />}
+              valueStyle={{ color: COLORS.blue }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Active Semesters"
+              value={overview.academic.activeSemesters}
+              prefix={<CalendarOutlined />}
+              valueStyle={{ color: COLORS.green }}
+            />
+          </Card>
+        </Col>
           <Col xs={24} sm={12} lg={6}>
             <Card>
               <Statistic
@@ -402,40 +402,40 @@
       <Card>
         <Title level={5} style={{ marginBottom: 16 }}>Class Statistics</Title>
         <Row gutter={[16, 16]}>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Total Classes"
-                value={overview.academic.totalClasses}
-                prefix={<BookOutlined />}
-                valueStyle={{ color: COLORS.cyan }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Average Students/Class"
-                value={overview.academic.averageStudentsPerClass || 0}
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Total Classes"
+              value={overview.academic.totalClasses}
+              prefix={<BookOutlined />}
+              valueStyle={{ color: COLORS.cyan }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Average Students/Class"
+              value={overview.academic.averageStudentsPerClass || 0}
                 prefix={<BarChartOutlined />}
-                valueStyle={{ color: COLORS.orange }}
-                precision={1}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Classes Without Students"
-                value={overview.academic.classesWithoutStudents || 0}
+              valueStyle={{ color: COLORS.orange }}
+              precision={1}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Classes Without Students"
+              value={overview.academic.classesWithoutStudents || 0}
                 prefix={<WarningOutlined />}
-                valueStyle={{ color: COLORS.red }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+              valueStyle={{ color: COLORS.red }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Classes Overloaded (>50)"
                 value={overview.academic.classesOverloaded || 0}
                 prefix={<WarningOutlined />}
@@ -457,25 +457,25 @@
                 value={overview.academic.totalStudents || 0}
                 prefix={<UsergroupAddOutlined />}
                 valueStyle={{ color: COLORS.blue }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Total Lecturers"
                 value={overview.academic.totalLecturers || 0}
                 prefix={<SolutionOutlined />}
                 valueStyle={{ color: COLORS.orange }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Student/Lecturer Ratio"
                 value={overview.academic.studentToLecturerRatio || 0}
-                prefix={<TeamOutlined />}
+              prefix={<TeamOutlined />}
                 valueStyle={{ color: COLORS.purple }}
                 precision={1}
               />
@@ -487,11 +487,11 @@
                 title="Semester Courses"
                 value={overview.academic.semesterCourses || 0}
                 prefix={<FileTextOutlined />}
-                valueStyle={{ color: COLORS.green }}
-              />
-            </Card>
-          </Col>
-        </Row>
+              valueStyle={{ color: COLORS.green }}
+            />
+          </Card>
+        </Col>
+      </Row>
       </Card>
 
       {/* Charts */}
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"AutoImportSettings\">\r\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"55c2a2ea-14a6-419e-8d9a-44362c500483\" name=\"Changes\" comment=\"Fix some UI\" />\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n    <option name=\"RESET_MODE\" value=\"SOFT\" />\r\n  </component>\r\n  <component name=\"GitHubPullRequestSearchHistory\">{\r\n  &quot;lastFilter&quot;: {\r\n    &quot;state&quot;: &quot;OPEN&quot;,\r\n    &quot;assignee&quot;: &quot;lethanbinh&quot;\r\n  }\r\n}</component>\r\n  <component name=\"GithubPullRequestsUISettings\">{\r\n  &quot;selectedUrlAndAccountId&quot;: {\r\n    &quot;url&quot;: &quot;https://github.com/lethanbinh/apsas-web.git&quot;,\r\n    &quot;accountId&quot;: &quot;b93c1590-533c-40d5-8641-b6e4528e19d4&quot;\r\n  }\r\n}</component>\r\n  <component name=\"ProjectColorInfo\">{\r\n  &quot;customColor&quot;: &quot;&quot;,\r\n  &quot;associatedIndex&quot;: 5\r\n}</component>\r\n  <component name=\"ProjectId\" id=\"34y2piGTIdQL2zs7JFp8p6gVu7P\" />\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">{\r\n  &quot;keyToString&quot;: {\r\n    &quot;ModuleVcsDetector.initialDetectionPerformed&quot;: &quot;true&quot;,\r\n    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,\r\n    &quot;RunOnceActivity.TerminalTabsStorage.copyFrom.TerminalArrangementManager.252&quot;: &quot;true&quot;,\r\n    &quot;RunOnceActivity.git.unshallow&quot;: &quot;true&quot;,\r\n    &quot;git-widget-placeholder&quot;: &quot;main&quot;,\r\n    &quot;js.debugger.nextJs.config.created.client&quot;: &quot;true&quot;,\r\n    &quot;js.debugger.nextJs.config.created.server&quot;: &quot;true&quot;,\r\n    &quot;kotlin-language-version-configured&quot;: &quot;true&quot;,\r\n    &quot;node.js.detected.package.eslint&quot;: &quot;true&quot;,\r\n    &quot;node.js.detected.package.tslint&quot;: &quot;true&quot;,\r\n    &quot;node.js.selected.package.eslint&quot;: &quot;(autodetect)&quot;,\r\n    &quot;node.js.selected.package.tslint&quot;: &quot;(autodetect)&quot;,\r\n    &quot;nodejs_package_manager_path&quot;: &quot;npm&quot;,\r\n    &quot;ts.external.directory.path&quot;: &quot;D:\\\\SourceFE\\\\apsas-web\\\\node_modules\\\\typescript\\\\lib&quot;,\r\n    &quot;vue.rearranger.settings.migration&quot;: &quot;true&quot;\r\n  }\r\n}</component>\r\n  <component name=\"RunManager\" selected=\"npm.Next.js: server-side\">\r\n    <configuration name=\"Next.js: debug client-side\" type=\"JavascriptDebugType\" uri=\"http://localhost:3000/\">\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <configuration name=\"Next.js: server-side\" type=\"js.build_tools.npm\">\r\n      <package-json value=\"$PROJECT_DIR$/package.json\" />\r\n      <command value=\"run\" />\r\n      <scripts>\r\n        <script value=\"dev\" />\r\n      </scripts>\r\n      <node-interpreter value=\"project\" />\r\n      <envs />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n  </component>\r\n  <component name=\"SharedIndexes\">\r\n    <attachedChunks>\r\n      <set>\r\n        <option value=\"bundled-jdk-9823dce3aa75-bf35d07a577b-intellij.indexing.shared.core-IU-252.27397.103\" />\r\n        <option value=\"bundled-js-predefined-d6986cc7102b-3aa1da707db6-JavaScript-IU-252.27397.103\" />\r\n      </set>\r\n    </attachedChunks>\r\n  </component>\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"55c2a2ea-14a6-419e-8d9a-44362c500483\" name=\"Changes\" comment=\"\" />\r\n      <created>1762171678143</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1762171678143</updated>\r\n      <workItem from=\"1762171679610\" duration=\"1697000\" />\r\n      <workItem from=\"1762178816952\" duration=\"4000\" />\r\n      <workItem from=\"1762229919429\" duration=\"69000\" />\r\n      <workItem from=\"1762230322334\" duration=\"5000\" />\r\n      <workItem from=\"1762270379353\" duration=\"165000\" />\r\n      <workItem from=\"1762310394294\" duration=\"3220000\" />\r\n      <workItem from=\"1762319614010\" duration=\"2218000\" />\r\n      <workItem from=\"1762326987903\" duration=\"676000\" />\r\n      <workItem from=\"1762393639073\" duration=\"2551000\" />\r\n      <workItem from=\"1762433359344\" duration=\"1424000\" />\r\n      <workItem from=\"1762444379590\" duration=\"73000\" />\r\n      <workItem from=\"1762482682788\" duration=\"1499000\" />\r\n      <workItem from=\"1762511425191\" duration=\"101000\" />\r\n      <workItem from=\"1762605144030\" duration=\"136000\" />\r\n      <workItem from=\"1762770321662\" duration=\"69000\" />\r\n      <workItem from=\"1762842716087\" duration=\"220000\" />\r\n      <workItem from=\"1762922149952\" duration=\"4395000\" />\r\n      <workItem from=\"1763013784721\" duration=\"125000\" />\r\n      <workItem from=\"1763013920940\" duration=\"24000\" />\r\n      <workItem from=\"1763093903482\" duration=\"1702000\" />\r\n      <workItem from=\"1763113040638\" duration=\"840000\" />\r\n      <workItem from=\"1763209659070\" duration=\"22000\" />\r\n      <workItem from=\"1763214598373\" duration=\"5000\" />\r\n      <workItem from=\"1763385158762\" duration=\"1671000\" />\r\n      <workItem from=\"1763561579212\" duration=\"30000\" />\r\n      <workItem from=\"1763632731368\" duration=\"1493000\" />\r\n      <workItem from=\"1763652869545\" duration=\"936000\" />\r\n      <workItem from=\"1763717528765\" duration=\"5752000\" />\r\n      <workItem from=\"1763741810513\" duration=\"68000\" />\r\n      <workItem from=\"1763787122395\" duration=\"1416000\" />\r\n      <workItem from=\"1763819187643\" duration=\"168000\" />\r\n      <workItem from=\"1763878786472\" duration=\"118000\" />\r\n      <workItem from=\"1763890480798\" duration=\"24000\" />\r\n    </task>\r\n    <task id=\"LOCAL-00001\" summary=\"Optimize speed and fix deploy\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762172112476</created>\r\n      <option name=\"number\" value=\"00001\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00001\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762172112476</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00002\" summary=\"Fix Bugs UI\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762178718338</created>\r\n      <option name=\"number\" value=\"00002\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00002\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762178718338</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00003\" summary=\"Fix bugs examiner role\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762229980250</created>\r\n      <option name=\"number\" value=\"00003\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00003\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762229980250</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00004\" summary=\"Exam shifts Management\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762320024223</created>\r\n      <option name=\"number\" value=\"00004\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00004\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762320024223</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00005\" summary=\"Fix build deploy\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762321823335</created>\r\n      <option name=\"number\" value=\"00005\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00005\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762321823335</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00006\" summary=\"Fix delete file\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762323175701</created>\r\n      <option name=\"number\" value=\"00006\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00006\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762323175701</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00007\" summary=\"Fix some UI bugs\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762327000296</created>\r\n      <option name=\"number\" value=\"00007\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00007\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762327000296</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00008\" summary=\"Fix UI admin\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762327422065</created>\r\n      <option name=\"number\" value=\"00008\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00008\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762327422065</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00009\" summary=\"Fix exam session. Do exam functions\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762482761409</created>\r\n      <option name=\"number\" value=\"00009\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00009\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762482761409</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00010\" summary=\"Fix bugs and complete teacher assign\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762770351907</created>\r\n      <option name=\"number\" value=\"00010\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00010\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762770351907</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00011\" summary=\"Fix bugs UI lecturer and student\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762928767527</created>\r\n      <option name=\"number\" value=\"00011\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00011\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762928767527</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00012\" summary=\"Fix grading UI\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762930097712</created>\r\n      <option name=\"number\" value=\"00012\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00012\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762930097712</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00013\" summary=\"fix building production\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1762930397900</created>\r\n      <option name=\"number\" value=\"00013\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00013\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1762930397900</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00014\" summary=\"Fix assign teacher examiner\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763013934037</created>\r\n      <option name=\"number\" value=\"00014\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00014\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763013934037</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00015\" summary=\"Fix template approval display\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763096193194</created>\r\n      <option name=\"number\" value=\"00015\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00015\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763096193194</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00016\" summary=\"fix building production\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763097168979</created>\r\n      <option name=\"number\" value=\"00016\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00016\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763097168979</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00017\" summary=\"Fix semester plan bugs\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763113867416</created>\r\n      <option name=\"number\" value=\"00017\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00017\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763113867416</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00018\" summary=\"Grade dsa and api\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763393332693</created>\r\n      <option name=\"number\" value=\"00018\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00018\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763393332693</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00019\" summary=\"Fix grade\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763652950009</created>\r\n      <option name=\"number\" value=\"00019\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00019\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763652950009</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00020\" summary=\"Fix grade\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763653133894</created>\r\n      <option name=\"number\" value=\"00020\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00020\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763653133894</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00021\" summary=\"Fix grade\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763741750542</created>\r\n      <option name=\"number\" value=\"00021\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00021\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763741750542</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00022\" summary=\"App download\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763819218439</created>\r\n      <option name=\"number\" value=\"00022\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00022\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763819218439</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00023\" summary=\"Fix some bugs admin\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763878845583</created>\r\n      <option name=\"number\" value=\"00023\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00023\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763878845583</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00024\" summary=\"Fix some UI\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1763890493415</created>\r\n      <option name=\"number\" value=\"00024\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00024\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1763890493415</updated>\r\n    </task>\r\n    <option name=\"localTasksCounter\" value=\"25\" />\r\n    <servers />\r\n  </component>\r\n  <component name=\"TypeScriptGeneratedFilesManager\">\r\n    <option name=\"version\" value=\"3\" />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State>\r\n              <option name=\"FILTERS\">\r\n                <map>\r\n                  <entry key=\"branch\">\r\n                    <value>\r\n                      <list>\r\n                        <option value=\"main\" />\r\n                      </list>\r\n                    </value>\r\n                  </entry>\r\n                </map>\r\n              </option>\r\n            </State>\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n  </component>\r\n  <component name=\"VcsManagerConfiguration\">\r\n    <MESSAGE value=\"Optimize speed and fix deploy\" />\r\n    <MESSAGE value=\"Fix Bugs UI\" />\r\n    <MESSAGE value=\"Fix bugs examiner role\" />\r\n    <MESSAGE value=\"Exam shifts Management\" />\r\n    <MESSAGE value=\"Fix build deploy\" />\r\n    <MESSAGE value=\"Fix delete file\" />\r\n    <MESSAGE value=\"Fix some UI bugs\" />\r\n    <MESSAGE value=\"Fix UI admin\" />\r\n    <MESSAGE value=\"Fix exam session. Do exam functions\" />\r\n    <MESSAGE value=\"Fix bugs and complete teacher assign\" />\r\n    <MESSAGE value=\"Fix bugs UI lecturer and student\" />\r\n    <MESSAGE value=\"Fix grading UI\" />\r\n    <MESSAGE value=\"Fix assign teacher examiner\" />\r\n    <MESSAGE value=\"Fix template approval display\" />\r\n    <MESSAGE value=\"fix building production\" />\r\n    <MESSAGE value=\"Fix semester plan bugs\" />\r\n    <MESSAGE value=\"Grade dsa and api\" />\r\n    <MESSAGE value=\"Fix grade\" />\r\n    <MESSAGE value=\"App download\" />\r\n    <MESSAGE value=\"Fix some bugs admin\" />\r\n    <MESSAGE value=\"Fix some UI\" />\r\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"Fix some UI\" />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision 6f9873a8330481f7416524ce2b29e489e3f5c3fa)
+++ b/.idea/workspace.xml	(date 1763997607921)
@@ -117,6 +117,7 @@
       <workItem from="1763819187643" duration="168000" />
       <workItem from="1763878786472" duration="118000" />
       <workItem from="1763890480798" duration="24000" />
+      <workItem from="1763972875572" duration="23000" />
     </task>
     <task id="LOCAL-00001" summary="Optimize speed and fix deploy">
       <option name="closed" value="true" />
Index: src/app/admin/dashboard/components/AssessmentsTab.tsx
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\"use client\";\r\n\r\nimport React, { useEffect, useState, useMemo } from \"react\";\r\nimport { Card, Row, Col, Statistic, Table, Tag, Typography, Space, Progress, Input, Select, DatePicker, Button, App } from \"antd\";\r\nimport {\r\n  FileTextOutlined,\r\n  CheckCircleOutlined,\r\n  ClockCircleOutlined,\r\n  UserOutlined,\r\n  CalendarOutlined,\r\n  SearchOutlined,\r\n  FilterOutlined,\r\n  FileExcelOutlined,\r\n  ExperimentOutlined,\r\n  BarChartOutlined,\r\n  WarningOutlined,\r\n  ThunderboltOutlined,\r\n  TrophyOutlined,\r\n} from \"@ant-design/icons\";\r\nimport { Dayjs } from \"dayjs\";\r\nimport * as XLSX from \"xlsx\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip as RechartsTooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\nimport { adminService } from \"@/services/adminService\";\r\nimport { classAssessmentService } from \"@/services/classAssessmentService\";\r\nimport type { DashboardOverview, ChartData } from \"@/services/adminDashboardService\";\r\nimport dayjs from \"dayjs\";\r\n\r\nconst { Title, Text } = Typography;\r\nconst { Search } = Input;\r\nconst { RangePicker } = DatePicker;\r\n\r\nconst COLORS = {\r\n  blue: \"#2563EB\",\r\n  green: \"#10B981\",\r\n  purple: \"#6D28D9\",\r\n  orange: \"#F59E0B\",\r\n  red: \"#EF4444\",\r\n  cyan: \"#06B6D4\",\r\n};\r\n\r\nconst CHART_COLORS = [\"#2563EB\", \"#10B981\", \"#6D28D9\", \"#F59E0B\", \"#EF4444\"];\r\n\r\ninterface AssessmentsTabProps {\r\n  overview: DashboardOverview | null;\r\n  chartData: ChartData | null;\r\n  loading: boolean;\r\n  onRefresh: () => void;\r\n}\r\n\r\nconst AssessmentsTab: React.FC<AssessmentsTabProps> = ({\r\n  overview,\r\n  chartData,\r\n  loading,\r\n}) => {\r\n  const { message } = App.useApp();\r\n  const [assessments, setAssessments] = useState<any[]>([]);\r\n  const [templates, setTemplates] = useState<any[]>([]);\r\n  const [assessmentsLoading, setAssessmentsLoading] = useState(false);\r\n  const [exportLoading, setExportLoading] = useState(false);\r\n\r\n  const handleExportExcel = () => {\r\n    if (!overview) {\r\n      message.warning(\"No data available to export\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setExportLoading(true);\r\n      const wb = XLSX.utils.book_new();\r\n\r\n      // All Statistics Cards Sheet (8 cards)\r\n      const statsData = [\r\n        [\"Metric\", \"Value\"],\r\n        [\"Total Templates\", overview.assessments.totalTemplates],\r\n        [\"Total Class Assessments\", overview.assessments.totalClassAssessments],\r\n        [\"Assignments\", overview.assessments.byType.assignment],\r\n        [\"Labs\", overview.assessments.byType.lab],\r\n        [\"Practical Exams\", overview.assessments.byType.practicalExam],\r\n        [\"Active Assessments\", overview.assessments.assessmentsByStatus?.active || 0],\r\n        [\"Completed Assessments\", overview.assessments.assessmentsByStatus?.completed || 0],\r\n        [\"Pending Assessments\", overview.assessments.assessmentsByStatus?.pending || 0],\r\n        [\"Average Submissions/Assessment\", overview.assessments.averageSubmissionsPerAssessment?.toFixed(1) || 0],\r\n        [\"Assessments Without Submissions\", overview.assessments.assessmentsWithoutSubmissions || 0],\r\n      ];\r\n      const ws1 = XLSX.utils.aoa_to_sheet(statsData);\r\n      XLSX.utils.book_append_sheet(wb, ws1, \"Statistics\");\r\n\r\n      // Assessment Type Distribution Chart Data (Pie Chart)\r\n      const assessmentDistribution = [\r\n        { name: \"Assignment\", value: overview.assessments.byType.assignment },\r\n        { name: \"Lab\", value: overview.assessments.byType.lab },\r\n        { name: \"Practical Exam\", value: overview.assessments.byType.practicalExam },\r\n      ];\r\n      const totalAssessments = assessmentDistribution.reduce((sum, item) => sum + item.value, 0);\r\n      const distributionData = assessmentDistribution.map((item) => ({\r\n        Type: item.name,\r\n        Count: item.value,\r\n        Percentage: totalAssessments > 0 ? ((item.value / totalAssessments) * 100).toFixed(2) + \"%\" : \"0%\",\r\n      }));\r\n      const ws2 = XLSX.utils.json_to_sheet(distributionData);\r\n      XLSX.utils.book_append_sheet(wb, ws2, \"Assessment Distribution\");\r\n\r\n      // Assessment Distribution Bar Chart Data\r\n      if (chartData?.assessmentDistribution && chartData.assessmentDistribution.length > 0) {\r\n        const barChartData = chartData.assessmentDistribution.map((item) => ({\r\n          Type: item.type,\r\n          Count: item.count,\r\n        }));\r\n        const ws3 = XLSX.utils.json_to_sheet(barChartData);\r\n        XLSX.utils.book_append_sheet(wb, ws3, \"Assessment Distribution (Bar)\");\r\n      }\r\n\r\n      // All Assessment Templates Table (Filtered)\r\n      const templatesData = filteredTemplates.map((tpl, index) => ({\r\n        \"No\": index + 1,\r\n        \"ID\": tpl.id,\r\n        \"Template Name\": tpl.name || \"\",\r\n        \"Type\": tpl.templateType === 0 ? \"Assignment\" : tpl.templateType === 1 ? \"Lab\" : \"Practical Exam\",\r\n        \"Course Element\": tpl.courseElementName || \"\",\r\n        \"Lecturer\": tpl.lecturerName || \"\",\r\n        \"Description\": tpl.description || \"\",\r\n        \"Created At\": tpl.createdAt ? dayjs(tpl.createdAt).format(\"YYYY-MM-DD\") : \"\",\r\n      }));\r\n      const ws4 = XLSX.utils.json_to_sheet(templatesData);\r\n      XLSX.utils.book_append_sheet(wb, ws4, \"All Templates\");\r\n\r\n      // All Class Assessments Table (Filtered)\r\n      const assessmentsData = filteredAssessments.map((ass, index) => ({\r\n        \"No\": index + 1,\r\n        \"ID\": ass.id,\r\n        \"Assessment Name\": ass.assessmentTemplateName || \"\",\r\n        \"Course Element\": ass.courseElementName || \"\",\r\n        \"Course\": ass.courseName || \"\",\r\n        \"Lecturer\": ass.lecturerName || \"\",\r\n        \"Status\": ass.status === 0 ? \"Pending\" : ass.status === 1 ? \"Active\" : \"Completed\",\r\n        \"Start Date\": ass.startAt ? dayjs(ass.startAt).format(\"YYYY-MM-DD\") : \"\",\r\n        \"End Date\": ass.endAt ? dayjs(ass.endAt).format(\"YYYY-MM-DD\") : \"\",\r\n        \"Submissions\": parseInt(ass.submissionCount || \"0\", 10),\r\n      }));\r\n      const ws5 = XLSX.utils.json_to_sheet(assessmentsData);\r\n      XLSX.utils.book_append_sheet(wb, ws5, \"All Class Assessments\");\r\n\r\n      // Top Assessments by Submissions\r\n      if (overview.assessments.topAssessmentsBySubmissions && overview.assessments.topAssessmentsBySubmissions.length > 0) {\r\n        const topAssessmentsData = overview.assessments.topAssessmentsBySubmissions.map((ass, index) => ({\r\n          \"Rank\": index + 1,\r\n          \"Assessment Name\": ass.name,\r\n          \"Course\": ass.courseName,\r\n          \"Submissions\": ass.submissionCount,\r\n          \"Lecturer\": ass.lecturerName,\r\n        }));\r\n        const ws6 = XLSX.utils.json_to_sheet(topAssessmentsData);\r\n        XLSX.utils.book_append_sheet(wb, ws6, \"Top Assessments\");\r\n      }\r\n\r\n      const fileName = `Assessments_Dashboard_${dayjs().format(\"YYYY-MM-DD\")}.xlsx`;\r\n      XLSX.writeFile(wb, fileName);\r\n      message.success(\"All assessments data exported successfully\");\r\n    } catch (error) {\r\n      console.error(\"Export error:\", error);\r\n      message.error(\"Failed to export assessments data\");\r\n    } finally {\r\n      setExportLoading(false);\r\n    }\r\n  };\r\n  const [templateSearch, setTemplateSearch] = useState(\"\");\r\n  const [assessmentSearch, setAssessmentSearch] = useState(\"\");\r\n  const [selectedTemplateType, setSelectedTemplateType] = useState<string | undefined>(undefined);\r\n  const [selectedAssessmentStatus, setSelectedAssessmentStatus] = useState<number | undefined>(undefined);\r\n  const [templateDateRange, setTemplateDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\r\n  const [assessmentDateRange, setAssessmentDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      setAssessmentsLoading(true);\r\n      const [assessmentsData, templatesData] = await Promise.all([\r\n        classAssessmentService.getClassAssessments({\r\n          pageNumber: 1,\r\n          pageSize: 1000,\r\n        }),\r\n        adminService.getAssessmentTemplateList(1, 1000),\r\n      ]);\r\n      setAssessments(assessmentsData.items);\r\n      setTemplates(templatesData.items);\r\n    } catch (error) {\r\n      console.error(\"Error fetching assessments data:\", error);\r\n    } finally {\r\n      setAssessmentsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Filter templates\r\n  const filteredTemplates = useMemo(() => {\r\n    let filtered = [...templates];\r\n\r\n    if (templateSearch) {\r\n      const searchLower = templateSearch.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (tpl) =>\r\n          tpl.name?.toLowerCase().includes(searchLower) ||\r\n          tpl.description?.toLowerCase().includes(searchLower) ||\r\n          tpl.courseElementName?.toLowerCase().includes(searchLower) ||\r\n          tpl.lecturerName?.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    if (selectedTemplateType) {\r\n      if (selectedTemplateType === \"lab\") {\r\n        const labKeywords = [\"lab\", \"laboratory\", \"thc hnh\", \"bi thc hnh\", \"lab session\", \"lab work\"];\r\n        filtered = filtered.filter((tpl) => {\r\n          const nameLower = (tpl.name || \"\").toLowerCase();\r\n          return labKeywords.some((keyword) => nameLower.includes(keyword));\r\n        });\r\n      } else if (selectedTemplateType === \"practical_exam\") {\r\n        const peKeywords = [\"exam\", \"pe\", \"practical exam\", \"practical\", \"test\", \"kim tra thc hnh\", \"thi thc hnh\", \"bi thi\", \"bi kim tra\"];\r\n        filtered = filtered.filter((tpl) => {\r\n          const nameLower = (tpl.name || \"\").toLowerCase();\r\n          return peKeywords.some((keyword) => nameLower.includes(keyword));\r\n        });\r\n      } else if (selectedTemplateType === \"assignment\") {\r\n        // Assignment is everything that's not lab or practical exam\r\n        const labKeywords = [\"lab\", \"laboratory\", \"thc hnh\", \"bi thc hnh\", \"lab session\", \"lab work\"];\r\n        const peKeywords = [\"exam\", \"pe\", \"practical exam\", \"practical\", \"test\", \"kim tra thc hnh\", \"thi thc hnh\", \"bi thi\", \"bi kim tra\"];\r\n        filtered = filtered.filter((tpl) => {\r\n          const nameLower = (tpl.name || \"\").toLowerCase();\r\n          return (\r\n            !labKeywords.some((keyword) => nameLower.includes(keyword)) &&\r\n            !peKeywords.some((keyword) => nameLower.includes(keyword))\r\n          );\r\n        });\r\n      }\r\n    }\r\n\r\n    if (templateDateRange && templateDateRange[0] && templateDateRange[1]) {\r\n      filtered = filtered.filter((tpl) => {\r\n        if (!tpl.createdAt) return false;\r\n        const createdAt = dayjs(tpl.createdAt);\r\n        const startDate = templateDateRange[0]!.startOf(\"day\");\r\n        const endDate = templateDateRange[1]!.endOf(\"day\");\r\n        return (\r\n          (createdAt.isAfter(startDate) || createdAt.isSame(startDate)) &&\r\n          (createdAt.isBefore(endDate) || createdAt.isSame(endDate))\r\n        );\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [templates, templateSearch, selectedTemplateType, templateDateRange]);\r\n\r\n  // Filter assessments\r\n  const filteredAssessments = useMemo(() => {\r\n    let filtered = [...assessments];\r\n\r\n    if (assessmentSearch) {\r\n      const searchLower = assessmentSearch.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (ass) =>\r\n          ass.assessmentTemplateName?.toLowerCase().includes(searchLower) ||\r\n          ass.courseElementName?.toLowerCase().includes(searchLower) ||\r\n          ass.courseName?.toLowerCase().includes(searchLower) ||\r\n          ass.lecturerName?.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    if (selectedAssessmentStatus !== undefined) {\r\n      filtered = filtered.filter((ass) => ass.status === selectedAssessmentStatus);\r\n    }\r\n\r\n    if (assessmentDateRange && assessmentDateRange[0] && assessmentDateRange[1]) {\r\n      filtered = filtered.filter((ass) => {\r\n        const startAt = dayjs(ass.startAt);\r\n        const endAt = dayjs(ass.endAt);\r\n        return (\r\n          (startAt.isAfter(assessmentDateRange[0]!.subtract(1, \"day\")) &&\r\n            startAt.isBefore(assessmentDateRange[1]!.add(1, \"day\"))) ||\r\n          (endAt.isAfter(assessmentDateRange[0]!.subtract(1, \"day\")) &&\r\n            endAt.isBefore(assessmentDateRange[1]!.add(1, \"day\")))\r\n        );\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [assessments, assessmentSearch, selectedAssessmentStatus, assessmentDateRange]);\r\n\r\n  if (!overview) return null;\r\n\r\n  const assessmentDistribution = [\r\n    { name: \"Assignment\", value: overview.assessments.byType.assignment, color: COLORS.blue },\r\n    { name: \"Lab\", value: overview.assessments.byType.lab, color: COLORS.green },\r\n    { name: \"Practical Exam\", value: overview.assessments.byType.practicalExam, color: COLORS.purple },\r\n  ];\r\n\r\n  const assessmentColumns = [\r\n    {\r\n      title: \"Assessment Name\",\r\n      dataIndex: \"assessmentTemplateName\",\r\n      key: \"assessmentTemplateName\",\r\n    },\r\n    {\r\n      title: \"Course Element\",\r\n      dataIndex: \"courseElementName\",\r\n      key: \"courseElementName\",\r\n    },\r\n    {\r\n      title: \"Course\",\r\n      dataIndex: \"courseName\",\r\n      key: \"courseName\",\r\n    },\r\n    {\r\n      title: \"Lecturer\",\r\n      dataIndex: \"lecturerName\",\r\n      key: \"lecturerName\",\r\n    },\r\n    {\r\n      title: \"Start Date\",\r\n      dataIndex: \"startAt\",\r\n      key: \"startAt\",\r\n      render: (date: string) => dayjs(date).format(\"MMM DD, YYYY HH:mm\"),\r\n    },\r\n    {\r\n      title: \"End Date\",\r\n      dataIndex: \"endAt\",\r\n      key: \"endAt\",\r\n      render: (date: string) => dayjs(date).format(\"MMM DD, YYYY HH:mm\"),\r\n    },\r\n    {\r\n      title: \"Submissions\",\r\n      dataIndex: \"submissionCount\",\r\n      key: \"submissionCount\",\r\n      render: (count: string) => parseInt(count) || 0,\r\n    },\r\n    {\r\n      title: \"Status\",\r\n      dataIndex: \"status\",\r\n      key: \"status\",\r\n      render: (status: number) => {\r\n        const statusMap: Record<number, { text: string; color: string }> = {\r\n          0: { text: \"Pending\", color: \"orange\" },\r\n          1: { text: \"Active\", color: \"green\" },\r\n          2: { text: \"Completed\", color: \"blue\" },\r\n        };\r\n        const statusInfo = statusMap[status] || { text: \"Unknown\", color: \"default\" };\r\n        return <Tag color={statusInfo.color}>{statusInfo.text}</Tag>;\r\n      },\r\n    },\r\n  ];\r\n\r\n  const templateColumns = [\r\n    {\r\n      title: \"Template Name\",\r\n      dataIndex: \"name\",\r\n      key: \"name\",\r\n    },\r\n    {\r\n      title: \"Type\",\r\n      dataIndex: \"templateType\",\r\n      key: \"templateType\",\r\n      render: (type: number) => {\r\n        const types = [\"Assignment\", \"Lab\", \"Practical Exam\"];\r\n        const colors = [\"blue\", \"green\", \"purple\"];\r\n        return <Tag color={colors[type] || \"default\"}>{types[type] || \"Unknown\"}</Tag>;\r\n      },\r\n    },\r\n    {\r\n      title: \"Course Element\",\r\n      dataIndex: \"courseElementName\",\r\n      key: \"courseElementName\",\r\n    },\r\n    {\r\n      title: \"Lecturer\",\r\n      dataIndex: \"lecturerName\",\r\n      key: \"lecturerName\",\r\n    },\r\n    {\r\n      title: \"Created At\",\r\n      dataIndex: \"createdAt\",\r\n      key: \"createdAt\",\r\n      render: (date: string) => dayjs(date).format(\"MMM DD, YYYY\"),\r\n    },\r\n    {\r\n      title: \"Status\",\r\n      dataIndex: \"status\",\r\n      key: \"status\",\r\n      render: (status: number) => {\r\n        const statusMap: Record<number, { text: string; color: string }> = {\r\n          0: { text: \"Draft\", color: \"orange\" },\r\n          1: { text: \"Active\", color: \"green\" },\r\n          2: { text: \"Archived\", color: \"default\" },\r\n        };\r\n        const statusInfo = statusMap[status] || { text: \"Unknown\", color: \"default\" };\r\n        return <Tag color={statusInfo.color}>{statusInfo.text}</Tag>;\r\n      },\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <Space direction=\"vertical\" size=\"large\" style={{ width: \"100%\" }}>\r\n      {/* Export Button Header */}\r\n      <Card>\r\n        <Space style={{ width: \"100%\", justifyContent: \"space-between\" }}>\r\n          <Title level={4} style={{ margin: 0 }}>Assessments Dashboard</Title>\r\n          <Button\r\n            icon={<FileExcelOutlined />}\r\n            onClick={handleExportExcel}\r\n            loading={exportLoading}\r\n            type=\"primary\"\r\n            size=\"large\"\r\n          >\r\n            Export All Data to Excel\r\n          </Button>\r\n        </Space>\r\n      </Card>\r\n\r\n      {/* Assessment Statistics Overview */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Assessment Statistics Overview</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Total Templates\"\r\n                value={overview.assessments.totalTemplates}\r\n                prefix={<FileTextOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Class Assessments\"\r\n                value={overview.assessments.totalClassAssessments}\r\n                prefix={<FileTextOutlined />}\r\n                valueStyle={{ color: COLORS.cyan }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Active Assessments\"\r\n                value={overview.assessments.assessmentsByStatus?.active || 0}\r\n                prefix={<ThunderboltOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Completed Assessments\"\r\n                value={overview.assessments.assessmentsByStatus?.completed || 0}\r\n                prefix={<CheckCircleOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n        <Row gutter={[16, 16]} style={{ marginTop: 16 }}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Pending Assessments\"\r\n                value={overview.assessments.assessmentsByStatus?.pending || 0}\r\n                prefix={<ClockCircleOutlined />}\r\n                valueStyle={{ color: COLORS.orange }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Without Submissions\"\r\n                value={overview.assessments.assessmentsWithoutSubmissions || 0}\r\n                prefix={<WarningOutlined />}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Avg Submissions/Assessment\"\r\n                value={overview.assessments.averageSubmissionsPerAssessment || 0}\r\n                precision={1}\r\n                prefix={<BarChartOutlined />}\r\n                valueStyle={{ color: COLORS.purple }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Upcoming Deadlines\"\r\n                value={overview.assessments.upcomingDeadlines?.length || 0}\r\n                prefix={<CalendarOutlined />}\r\n                valueStyle={{ color: COLORS.orange }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Assessment by Type */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Assessments by Type</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={8}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Assignments\"\r\n                value={overview.assessments.byType.assignment}\r\n                prefix={<FileTextOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={8}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Labs\"\r\n                value={overview.assessments.byType.lab}\r\n                prefix={<ExperimentOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={8}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Practical Exams\"\r\n                value={overview.assessments.byType.practicalExam}\r\n                prefix={<BarChartOutlined />}\r\n                valueStyle={{ color: COLORS.purple }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Charts */}\r\n      <Row gutter={[16, 16]}>\r\n        <Col xs={24} lg={12}>\r\n          <Card title=\"Assessment Type Distribution\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <PieChart>\r\n                <Pie\r\n                  data={assessmentDistribution}\r\n                  cx=\"50%\"\r\n                  cy=\"50%\"\r\n                  labelLine={false}\r\n                  label={(entry: any) =>\r\n                    `${entry.name} ${(entry.percent * 100).toFixed(0)}%`\r\n                  }\r\n                  outerRadius={80}\r\n                  fill=\"#8884d8\"\r\n                  dataKey=\"value\"\r\n                >\r\n                  {assessmentDistribution.map((entry, index) => (\r\n                    <Cell key={`cell-${index}`} fill={entry.color} />\r\n                  ))}\r\n                </Pie>\r\n                <RechartsTooltip />\r\n              </PieChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n\r\n        <Col xs={24} lg={12}>\r\n          <Card title=\"Assessment Distribution (Chart Data)\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <BarChart data={chartData?.assessmentDistribution || []}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"type\" />\r\n                <YAxis />\r\n                <RechartsTooltip />\r\n                <Bar dataKey=\"count\" fill={COLORS.blue} />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Top Assessments */}\r\n      {overview.assessments.topAssessmentsBySubmissions && overview.assessments.topAssessmentsBySubmissions.length > 0 && (\r\n        <Card title=\"Top Assessments by Submissions\">\r\n          <Table\r\n            columns={[\r\n              {\r\n                title: \"Assessment Name\",\r\n                dataIndex: \"name\",\r\n                key: \"name\",\r\n              },\r\n              {\r\n                title: \"Course\",\r\n                dataIndex: \"courseName\",\r\n                key: \"courseName\",\r\n              },\r\n              {\r\n                title: \"Lecturer\",\r\n                dataIndex: \"lecturerName\",\r\n                key: \"lecturerName\",\r\n              },\r\n              {\r\n                title: \"Submissions\",\r\n                dataIndex: \"submissionCount\",\r\n                key: \"submissionCount\",\r\n                render: (count: number) => (\r\n                  <Tag color=\"blue\">{count}</Tag>\r\n                ),\r\n              },\r\n            ]}\r\n            dataSource={overview.assessments.topAssessmentsBySubmissions}\r\n            rowKey=\"id\"\r\n            pagination={false}\r\n            size=\"small\"\r\n          />\r\n        </Card>\r\n      )}\r\n\r\n      {/* Assessment Templates Table */}\r\n      <Card\r\n        title=\"Assessment Templates\"\r\n        loading={assessmentsLoading}\r\n        extra={\r\n          <Space>\r\n            <Select\r\n              placeholder=\"Filter by Type\"\r\n              allowClear\r\n              style={{ width: 150 }}\r\n              value={selectedTemplateType}\r\n              onChange={setSelectedTemplateType}\r\n              suffixIcon={<FilterOutlined />}\r\n            >\r\n              <Select.Option value=\"assignment\">Assignment</Select.Option>\r\n              <Select.Option value=\"lab\">Lab</Select.Option>\r\n              <Select.Option value=\"practical_exam\">Practical Exam</Select.Option>\r\n            </Select>\r\n            <RangePicker\r\n              placeholder={[\"Start Date\", \"End Date\"]}\r\n              value={templateDateRange}\r\n              onChange={(dates) => setTemplateDateRange(dates as [Dayjs | null, Dayjs | null] | null)}\r\n              style={{ width: 250 }}\r\n              allowClear\r\n            />\r\n          </Space>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: \"100%\", marginBottom: 16 }}>\r\n          <Search\r\n            placeholder=\"Search by name, description, course element, or lecturer\"\r\n            allowClear\r\n            enterButton={<SearchOutlined />}\r\n            size=\"large\"\r\n            value={templateSearch}\r\n            onChange={(e) => setTemplateSearch(e.target.value)}\r\n            onSearch={setTemplateSearch}\r\n          />\r\n          <Text type=\"secondary\">\r\n            Showing {filteredTemplates.length} of {templates.length} templates\r\n          </Text>\r\n        </Space>\r\n        <Table\r\n          columns={templateColumns}\r\n          dataSource={filteredTemplates}\r\n          rowKey=\"id\"\r\n          pagination={{ pageSize: 10, showTotal: (total) => `Total ${total} templates` }}\r\n          scroll={{ x: 1000 }}\r\n        />\r\n      </Card>\r\n\r\n      {/* Class Assessments Table */}\r\n      <Card\r\n        title=\"Class Assessments\"\r\n        loading={assessmentsLoading}\r\n        extra={\r\n          <Space>\r\n            <Select\r\n              placeholder=\"Filter by Status\"\r\n              allowClear\r\n              style={{ width: 150 }}\r\n              value={selectedAssessmentStatus}\r\n              onChange={setSelectedAssessmentStatus}\r\n              suffixIcon={<FilterOutlined />}\r\n            >\r\n              <Select.Option value={0}>Pending</Select.Option>\r\n              <Select.Option value={1}>Active</Select.Option>\r\n              <Select.Option value={2}>Completed</Select.Option>\r\n            </Select>\r\n            <RangePicker\r\n              placeholder={[\"Start Date\", \"End Date\"]}\r\n              value={assessmentDateRange}\r\n              onChange={(dates) => setAssessmentDateRange(dates as [Dayjs | null, Dayjs | null] | null)}\r\n              style={{ width: 250 }}\r\n              allowClear\r\n            />\r\n          </Space>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: \"100%\", marginBottom: 16 }}>\r\n          <Search\r\n            placeholder=\"Search by assessment name, course element, course, or lecturer\"\r\n            allowClear\r\n            enterButton={<SearchOutlined />}\r\n            size=\"large\"\r\n            value={assessmentSearch}\r\n            onChange={(e) => setAssessmentSearch(e.target.value)}\r\n            onSearch={setAssessmentSearch}\r\n          />\r\n          <Text type=\"secondary\">\r\n            Showing {filteredAssessments.length} of {assessments.length} assessments\r\n          </Text>\r\n        </Space>\r\n        <Table\r\n          columns={assessmentColumns}\r\n          dataSource={filteredAssessments}\r\n          rowKey=\"id\"\r\n          pagination={{ pageSize: 10, showTotal: (total) => `Total ${total} assessments` }}\r\n          scroll={{ x: 1200 }}\r\n        />\r\n      </Card>\r\n    </Space>\r\n  );\r\n};\r\n\r\nexport default AssessmentsTab;
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/app/admin/dashboard/components/AssessmentsTab.tsx b/src/app/admin/dashboard/components/AssessmentsTab.tsx
--- a/src/app/admin/dashboard/components/AssessmentsTab.tsx	(revision 6f9873a8330481f7416524ce2b29e489e3f5c3fa)
+++ b/src/app/admin/dashboard/components/AssessmentsTab.tsx	(date 1763996951193)
@@ -430,37 +430,37 @@
       {/* Assessment Statistics Overview */}
       <Card>
         <Title level={5} style={{ marginBottom: 16 }}>Assessment Statistics Overview</Title>
-        <Row gutter={[16, 16]}>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Total Templates"
-                value={overview.assessments.totalTemplates}
-                prefix={<FileTextOutlined />}
-                valueStyle={{ color: COLORS.blue }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Class Assessments"
-                value={overview.assessments.totalClassAssessments}
-                prefix={<FileTextOutlined />}
-                valueStyle={{ color: COLORS.cyan }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Active Assessments"
-                value={overview.assessments.assessmentsByStatus?.active || 0}
+      <Row gutter={[16, 16]}>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Total Templates"
+              value={overview.assessments.totalTemplates}
+              prefix={<FileTextOutlined />}
+              valueStyle={{ color: COLORS.blue }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Class Assessments"
+              value={overview.assessments.totalClassAssessments}
+              prefix={<FileTextOutlined />}
+              valueStyle={{ color: COLORS.cyan }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Active Assessments"
+              value={overview.assessments.assessmentsByStatus?.active || 0}
                 prefix={<ThunderboltOutlined />}
-                valueStyle={{ color: COLORS.green }}
-              />
-            </Card>
-          </Col>
+              valueStyle={{ color: COLORS.green }}
+            />
+          </Card>
+        </Col>
           <Col xs={24} sm={12} lg={6}>
             <Card>
               <Statistic
@@ -473,48 +473,48 @@
           </Col>
         </Row>
         <Row gutter={[16, 16]} style={{ marginTop: 16 }}>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Pending Assessments"
-                value={overview.assessments.assessmentsByStatus?.pending || 0}
-                prefix={<ClockCircleOutlined />}
-                valueStyle={{ color: COLORS.orange }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Pending Assessments"
+              value={overview.assessments.assessmentsByStatus?.pending || 0}
+              prefix={<ClockCircleOutlined />}
+              valueStyle={{ color: COLORS.orange }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Without Submissions"
                 value={overview.assessments.assessmentsWithoutSubmissions || 0}
                 prefix={<WarningOutlined />}
                 valueStyle={{ color: COLORS.red }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Avg Submissions/Assessment"
                 value={overview.assessments.averageSubmissionsPerAssessment || 0}
                 precision={1}
                 prefix={<BarChartOutlined />}
-                valueStyle={{ color: COLORS.purple }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+              valueStyle={{ color: COLORS.purple }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Upcoming Deadlines"
                 value={overview.assessments.upcomingDeadlines?.length || 0}
                 prefix={<CalendarOutlined />}
-                valueStyle={{ color: COLORS.orange }}
-              />
-            </Card>
-          </Col>
-        </Row>
+              valueStyle={{ color: COLORS.orange }}
+            />
+          </Card>
+        </Col>
+      </Row>
       </Card>
 
       {/* Assessment by Type */}
Index: src/app/admin/dashboard/components/GradingTab.tsx
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\"use client\";\r\n\r\nimport React, { useEffect, useState, useMemo } from \"react\";\r\nimport { Card, Row, Col, Statistic, Table, Tag, Typography, Space, Progress, Input, Select, DatePicker, Button, App } from \"antd\";\r\nimport {\r\n  CheckCircleOutlined,\r\n  ClockCircleOutlined,\r\n  BarChartOutlined,\r\n  UserOutlined,\r\n  FileTextOutlined,\r\n  TeamOutlined,\r\n  SearchOutlined,\r\n  FilterOutlined,\r\n  FileExcelOutlined,\r\n  WarningOutlined,\r\n  ThunderboltOutlined,\r\n  RobotOutlined,\r\n  SolutionOutlined,\r\n  TrophyOutlined,\r\n} from \"@ant-design/icons\";\r\nimport { Dayjs } from \"dayjs\";\r\nimport * as XLSX from \"xlsx\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip as RechartsTooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\nimport { gradingGroupService } from \"@/services/gradingGroupService\";\r\nimport { gradingService } from \"@/services/gradingService\";\r\nimport { adminService } from \"@/services/adminService\";\r\nimport type { DashboardOverview, ChartData } from \"@/services/adminDashboardService\";\r\nimport dayjs from \"dayjs\";\r\n\r\nconst { Title, Text } = Typography;\r\nconst { Search } = Input;\r\nconst { RangePicker } = DatePicker;\r\n\r\nconst COLORS = {\r\n  blue: \"#2563EB\",\r\n  green: \"#10B981\",\r\n  purple: \"#6D28D9\",\r\n  orange: \"#F59E0B\",\r\n  red: \"#EF4444\",\r\n  cyan: \"#06B6D4\",\r\n};\r\n\r\ninterface GradingTabProps {\r\n  overview: DashboardOverview | null;\r\n  chartData: ChartData | null;\r\n  loading: boolean;\r\n  onRefresh: () => void;\r\n}\r\n\r\nconst GradingTab: React.FC<GradingTabProps> = ({\r\n  overview,\r\n  chartData,\r\n  loading,\r\n}) => {\r\n  const { message } = App.useApp();\r\n  const [gradingGroups, setGradingGroups] = useState<any[]>([]);\r\n  const [gradingSessions, setGradingSessions] = useState<any[]>([]);\r\n  const [assignRequests, setAssignRequests] = useState<any[]>([]);\r\n  const [gradingGroupsLoading, setGradingGroupsLoading] = useState(false);\r\n  const [sessionsLoading, setSessionsLoading] = useState(false);\r\n  const [requestsLoading, setRequestsLoading] = useState(false);\r\n  const [exportLoading, setExportLoading] = useState(false);\r\n\r\n  const handleExportExcel = () => {\r\n    if (!overview) {\r\n      message.warning(\"No data available to export\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setExportLoading(true);\r\n      const wb = XLSX.utils.book_new();\r\n\r\n      // All Statistics Cards Sheet (6 cards)\r\n      const statsData = [\r\n        [\"Metric\", \"Value\"],\r\n        [\"Total Grading Groups\", overview.grading.totalGradingGroups],\r\n        [\"Total Grading Sessions\", overview.grading.totalGradingSessions],\r\n        [\"Completed Sessions\", overview.grading.completedGradingSessions || 0],\r\n        [\"Processing Sessions\", processingSessions.length],\r\n        [\"Failed Sessions\", failedSessions.length],\r\n        [\"Pending Assign Requests\", overview.grading.pendingAssignRequests],\r\n        [\"Average Grading Time\", overview.grading.averageGradingTime?.toFixed(2) || \"N/A\"],\r\n      ];\r\n      const ws1 = XLSX.utils.aoa_to_sheet(statsData);\r\n      XLSX.utils.book_append_sheet(wb, ws1, \"Statistics\");\r\n\r\n      // Grading Session Status Distribution Chart Data (Pie Chart)\r\n      const totalSessions = gradingSessions.length;\r\n      const sessionStatusData = [\r\n        { Status: \"Completed\", Count: completedSessions.length, Percentage: totalSessions > 0 ? ((completedSessions.length / totalSessions) * 100).toFixed(2) + \"%\" : \"0%\" },\r\n        { Status: \"Processing\", Count: processingSessions.length, Percentage: totalSessions > 0 ? ((processingSessions.length / totalSessions) * 100).toFixed(2) + \"%\" : \"0%\" },\r\n        { Status: \"Failed\", Count: failedSessions.length, Percentage: totalSessions > 0 ? ((failedSessions.length / totalSessions) * 100).toFixed(2) + \"%\" : \"0%\" },\r\n      ];\r\n      const ws2 = XLSX.utils.json_to_sheet(sessionStatusData);\r\n      XLSX.utils.book_append_sheet(wb, ws2, \"Session Status Distribution\");\r\n\r\n      // Grading Session Type Distribution Chart Data (Pie Chart)\r\n      const aiSessions = gradingSessions.filter((s) => s.gradingType === 0).length;\r\n      const lecturerSessions = gradingSessions.filter((s) => s.gradingType === 1).length;\r\n      const bothSessions = gradingSessions.filter((s) => s.gradingType === 2).length;\r\n      const sessionTypeData = [\r\n        { Type: \"AI\", Count: aiSessions, Percentage: totalSessions > 0 ? ((aiSessions / totalSessions) * 100).toFixed(2) + \"%\" : \"0%\" },\r\n        { Type: \"Lecturer\", Count: lecturerSessions, Percentage: totalSessions > 0 ? ((lecturerSessions / totalSessions) * 100).toFixed(2) + \"%\" : \"0%\" },\r\n        { Type: \"Both\", Count: bothSessions, Percentage: totalSessions > 0 ? ((bothSessions / totalSessions) * 100).toFixed(2) + \"%\" : \"0%\" },\r\n      ];\r\n      const ws3 = XLSX.utils.json_to_sheet(sessionTypeData);\r\n      XLSX.utils.book_append_sheet(wb, ws3, \"Session Type Distribution\");\r\n\r\n      // Grading Performance Chart Data (Line Chart - Last 30 Days)\r\n      if (chartData?.gradingPerformance && chartData.gradingPerformance.length > 0) {\r\n        const gradingPerformanceData = chartData.gradingPerformance.map((item) => ({\r\n          Date: item.date,\r\n          Graded: item.graded,\r\n          Pending: item.pending,\r\n        }));\r\n        const ws4 = XLSX.utils.json_to_sheet(gradingPerformanceData);\r\n        XLSX.utils.book_append_sheet(wb, ws4, \"Grading Performance\");\r\n      }\r\n\r\n      // Grading by Lecturer Chart Data (Bar Chart)\r\n      if (overview.grading.gradingByLecturer && overview.grading.gradingByLecturer.length > 0) {\r\n        const gradingByLecturerData = overview.grading.gradingByLecturer.map((item) => ({\r\n          Lecturer: item.lecturerName,\r\n          \"Session Count\": item.sessionCount,\r\n          \"Completed Count\": item.completedCount,\r\n        }));\r\n        const ws8 = XLSX.utils.json_to_sheet(gradingByLecturerData);\r\n        XLSX.utils.book_append_sheet(wb, ws8, \"Grading by Lecturer\");\r\n      }\r\n\r\n      // All Grading Groups Table (Filtered)\r\n      const groupsData = filteredGradingGroups.map((group, index) => ({\r\n        \"No\": index + 1,\r\n        \"ID\": group.id,\r\n        \"Lecturer\": group.lecturerName || \"\",\r\n        \"Lecturer Code\": group.lecturerCode || \"\",\r\n        \"Assessment Template\": group.assessmentTemplateName || \"\",\r\n        \"Submissions\": group.submissionCount || 0,\r\n        \"Created At\": group.createdAt ? dayjs(group.createdAt).format(\"YYYY-MM-DD\") : \"\",\r\n      }));\r\n      const ws5 = XLSX.utils.json_to_sheet(groupsData);\r\n      XLSX.utils.book_append_sheet(wb, ws5, \"All Grading Groups\");\r\n\r\n      // All Grading Sessions Table (Filtered)\r\n      const sessionsData = filteredGradingSessions.map((session, index) => ({\r\n        \"No\": index + 1,\r\n        \"ID\": session.id,\r\n        \"Student Name\": session.submissionStudentName || \"\",\r\n        \"Student Code\": session.submissionStudentCode || \"\",\r\n        \"Status\": session.status === 0 ? \"Processing\" : session.status === 1 ? \"Completed\" : \"Failed\",\r\n        \"Type\": session.gradingType === 0 ? \"AI\" : session.gradingType === 1 ? \"Lecturer\" : \"Both\",\r\n        \"Grade\": session.grade || 0,\r\n        \"Created At\": session.createdAt ? dayjs(session.createdAt).format(\"YYYY-MM-DD HH:mm\") : \"\",\r\n      }));\r\n      const ws6 = XLSX.utils.json_to_sheet(sessionsData);\r\n      XLSX.utils.book_append_sheet(wb, ws6, \"All Grading Sessions\");\r\n\r\n      // All Assign Requests Table (Filtered)\r\n      const requestsData = filteredAssignRequests.map((request, index) => ({\r\n        \"No\": index + 1,\r\n        \"ID\": request.id,\r\n        \"Course Element\": request.courseElementName || \"\",\r\n        \"Course\": request.courseName || \"\",\r\n        \"Assigned Lecturer\": request.assignedLecturerName || \"\",\r\n        \"Assigned By HOD\": request.assignedByHODName || \"\",\r\n        \"Status\": request.status === 0 ? \"Pending\" : request.status === 1 ? \"Approved\" : \"Rejected\",\r\n        \"Created At\": request.createdAt ? dayjs(request.createdAt).format(\"YYYY-MM-DD\") : \"\",\r\n      }));\r\n      const ws7 = XLSX.utils.json_to_sheet(requestsData);\r\n      XLSX.utils.book_append_sheet(wb, ws7, \"All Assign Requests\");\r\n\r\n      const fileName = `Grading_Dashboard_${dayjs().format(\"YYYY-MM-DD\")}.xlsx`;\r\n      XLSX.writeFile(wb, fileName);\r\n      message.success(\"All grading data exported successfully\");\r\n    } catch (error) {\r\n      console.error(\"Export error:\", error);\r\n      message.error(\"Failed to export grading data\");\r\n    } finally {\r\n      setExportLoading(false);\r\n    }\r\n  };\r\n  \r\n  // Filters for grading groups\r\n  const [groupSearch, setGroupSearch] = useState(\"\");\r\n  const [groupDateRange, setGroupDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\r\n  \r\n  // Filters for grading sessions\r\n  const [sessionSearch, setSessionSearch] = useState(\"\");\r\n  const [selectedSessionStatus, setSelectedSessionStatus] = useState<number | undefined>(undefined);\r\n  const [selectedSessionType, setSelectedSessionType] = useState<number | undefined>(undefined);\r\n  const [sessionDateRange, setSessionDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\r\n  \r\n  // Filters for assign requests\r\n  const [requestSearch, setRequestSearch] = useState(\"\");\r\n  const [selectedRequestStatus, setSelectedRequestStatus] = useState<number | undefined>(undefined);\r\n  const [requestDateRange, setRequestDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      setGradingGroupsLoading(true);\r\n      setSessionsLoading(true);\r\n      setRequestsLoading(true);\r\n      \r\n      const [groupsData, sessionsData, requestsData] = await Promise.all([\r\n        gradingGroupService.getGradingGroups({}),\r\n        gradingService.getGradingSessions({ pageNumber: 1, pageSize: 1000 }),\r\n        adminService.getApprovalList(1, 1000),\r\n      ]);\r\n      \r\n      setGradingGroups(groupsData);\r\n      setGradingSessions(sessionsData.items);\r\n      setAssignRequests(requestsData.items);\r\n    } catch (error) {\r\n      console.error(\"Error fetching grading data:\", error);\r\n    } finally {\r\n      setGradingGroupsLoading(false);\r\n      setSessionsLoading(false);\r\n      setRequestsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Filter grading groups\r\n  const filteredGradingGroups = useMemo(() => {\r\n    let filtered = [...gradingGroups];\r\n\r\n    if (groupSearch) {\r\n      const searchLower = groupSearch.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (group) =>\r\n          group.lecturerName?.toLowerCase().includes(searchLower) ||\r\n          group.lecturerCode?.toLowerCase().includes(searchLower) ||\r\n          group.assessmentTemplateName?.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    if (groupDateRange && groupDateRange[0] && groupDateRange[1]) {\r\n      filtered = filtered.filter((group) => {\r\n        if (!group.createdAt) return false;\r\n        const createdAt = dayjs(group.createdAt);\r\n        const startDate = groupDateRange[0]!.startOf(\"day\");\r\n        const endDate = groupDateRange[1]!.endOf(\"day\");\r\n        return (\r\n          (createdAt.isAfter(startDate) || createdAt.isSame(startDate)) &&\r\n          (createdAt.isBefore(endDate) || createdAt.isSame(endDate))\r\n        );\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [gradingGroups, groupSearch, groupDateRange]);\r\n\r\n  // Filter grading sessions\r\n  const filteredGradingSessions = useMemo(() => {\r\n    let filtered = [...gradingSessions];\r\n\r\n    if (sessionSearch) {\r\n      const searchLower = sessionSearch.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (session) =>\r\n          session.submissionStudentName?.toLowerCase().includes(searchLower) ||\r\n          session.submissionStudentCode?.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    if (selectedSessionStatus !== undefined) {\r\n      filtered = filtered.filter((session) => session.status === selectedSessionStatus);\r\n    }\r\n\r\n    if (selectedSessionType !== undefined) {\r\n      filtered = filtered.filter((session) => session.gradingType === selectedSessionType);\r\n    }\r\n\r\n    if (sessionDateRange && sessionDateRange[0] && sessionDateRange[1]) {\r\n      filtered = filtered.filter((session) => {\r\n        if (!session.createdAt) return false;\r\n        const createdAt = dayjs(session.createdAt);\r\n        const startDate = sessionDateRange[0]!.startOf(\"day\");\r\n        const endDate = sessionDateRange[1]!.endOf(\"day\");\r\n        return (\r\n          (createdAt.isAfter(startDate) || createdAt.isSame(startDate)) &&\r\n          (createdAt.isBefore(endDate) || createdAt.isSame(endDate))\r\n        );\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [gradingSessions, sessionSearch, selectedSessionStatus, selectedSessionType, sessionDateRange]);\r\n\r\n  // Filter assign requests\r\n  const filteredAssignRequests = useMemo(() => {\r\n    let filtered = [...assignRequests];\r\n\r\n    if (requestSearch) {\r\n      const searchLower = requestSearch.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (request) =>\r\n          request.courseElementName?.toLowerCase().includes(searchLower) ||\r\n          request.courseName?.toLowerCase().includes(searchLower) ||\r\n          request.assignedLecturerName?.toLowerCase().includes(searchLower) ||\r\n          request.assignedByHODName?.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    if (selectedRequestStatus !== undefined) {\r\n      filtered = filtered.filter((request) => request.status === selectedRequestStatus);\r\n    }\r\n\r\n    if (requestDateRange && requestDateRange[0] && requestDateRange[1]) {\r\n      filtered = filtered.filter((request) => {\r\n        if (!request.createdAt) return false;\r\n        const createdAt = dayjs(request.createdAt);\r\n        const startDate = requestDateRange[0]!.startOf(\"day\");\r\n        const endDate = requestDateRange[1]!.endOf(\"day\");\r\n        return (\r\n          (createdAt.isAfter(startDate) || createdAt.isSame(startDate)) &&\r\n          (createdAt.isBefore(endDate) || createdAt.isSame(endDate))\r\n        );\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [assignRequests, requestSearch, selectedRequestStatus, requestDateRange]);\r\n\r\n  if (!overview) return null;\r\n\r\n  const gradingGroupColumns = [\r\n    {\r\n      title: \"ID\",\r\n      dataIndex: \"id\",\r\n      key: \"id\",\r\n      width: 80,\r\n    },\r\n    {\r\n      title: \"Lecturer\",\r\n      key: \"lecturer\",\r\n      render: (_: any, record: any) => (\r\n        <Space>\r\n          <UserOutlined />\r\n          <span>{record.lecturerName || \"N/A\"} ({record.lecturerCode || \"N/A\"})</span>\r\n        </Space>\r\n      ),\r\n    },\r\n    {\r\n      title: \"Assessment Template\",\r\n      dataIndex: \"assessmentTemplateName\",\r\n      key: \"assessmentTemplateName\",\r\n      render: (name: string) => name || \"N/A\",\r\n    },\r\n    {\r\n      title: \"Submissions\",\r\n      dataIndex: \"submissionCount\",\r\n      key: \"submissionCount\",\r\n      render: (count: number) => (\r\n        <Tag color=\"blue\">{count || 0}</Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: \"Created At\",\r\n      dataIndex: \"createdAt\",\r\n      key: \"createdAt\",\r\n      render: (date: string) => dayjs(date).format(\"MMM DD, YYYY\"),\r\n    },\r\n  ];\r\n\r\n  const sessionColumns = [\r\n    {\r\n      title: \"ID\",\r\n      dataIndex: \"id\",\r\n      key: \"id\",\r\n      width: 80,\r\n    },\r\n    {\r\n      title: \"Student\",\r\n      key: \"student\",\r\n      render: (_: any, record: any) => (\r\n        <Space>\r\n          <UserOutlined />\r\n          <span>{record.submissionStudentName} ({record.submissionStudentCode})</span>\r\n        </Space>\r\n      ),\r\n    },\r\n    {\r\n      title: \"Grade\",\r\n      dataIndex: \"grade\",\r\n      key: \"grade\",\r\n      render: (grade: number) => (\r\n        <Tag color={grade > 0 ? \"green\" : \"default\"}>\r\n          {grade > 0 ? grade.toFixed(2) : \"N/A\"}\r\n        </Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: \"Type\",\r\n      dataIndex: \"gradingType\",\r\n      key: \"gradingType\",\r\n      render: (type: number) => {\r\n        const types = [\"AI\", \"Lecturer\", \"Both\"];\r\n        const colors = [\"blue\", \"purple\", \"green\"];\r\n        return <Tag color={colors[type] || \"default\"}>{types[type] || \"Unknown\"}</Tag>;\r\n      },\r\n    },\r\n    {\r\n      title: \"Status\",\r\n      dataIndex: \"status\",\r\n      key: \"status\",\r\n      render: (status: number) => {\r\n        const statusMap: Record<number, { text: string; color: string }> = {\r\n          0: { text: \"Processing\", color: \"orange\" },\r\n          1: { text: \"Completed\", color: \"green\" },\r\n          2: { text: \"Failed\", color: \"red\" },\r\n        };\r\n        const statusInfo = statusMap[status] || { text: \"Unknown\", color: \"default\" };\r\n        return <Tag color={statusInfo.color}>{statusInfo.text}</Tag>;\r\n      },\r\n    },\r\n    {\r\n      title: \"Created At\",\r\n      dataIndex: \"createdAt\",\r\n      key: \"createdAt\",\r\n      render: (date: string) => dayjs(date).format(\"MMM DD, YYYY HH:mm\"),\r\n    },\r\n  ];\r\n\r\n  const requestColumns = [\r\n    {\r\n      title: \"ID\",\r\n      dataIndex: \"id\",\r\n      key: \"id\",\r\n      width: 80,\r\n    },\r\n    {\r\n      title: \"Course Element\",\r\n      dataIndex: \"courseElementName\",\r\n      key: \"courseElementName\",\r\n    },\r\n    {\r\n      title: \"Course\",\r\n      dataIndex: \"courseName\",\r\n      key: \"courseName\",\r\n    },\r\n    {\r\n      title: \"Lecturer\",\r\n      dataIndex: \"assignedLecturerName\",\r\n      key: \"assignedLecturerName\",\r\n    },\r\n    {\r\n      title: \"HOD\",\r\n      dataIndex: \"assignedByHODName\",\r\n      key: \"assignedByHODName\",\r\n    },\r\n    {\r\n      title: \"Status\",\r\n      dataIndex: \"status\",\r\n      key: \"status\",\r\n      render: (status: number) => {\r\n        const statusMap: Record<number, { text: string; color: string }> = {\r\n          0: { text: \"Pending\", color: \"orange\" },\r\n          1: { text: \"Approved\", color: \"green\" },\r\n          2: { text: \"Rejected\", color: \"red\" },\r\n        };\r\n        const statusInfo = statusMap[status] || { text: \"Unknown\", color: \"default\" };\r\n        return <Tag color={statusInfo.color}>{statusInfo.text}</Tag>;\r\n      },\r\n    },\r\n    {\r\n      title: \"Created At\",\r\n      dataIndex: \"createdAt\",\r\n      key: \"createdAt\",\r\n      render: (date: string) => dayjs(date).format(\"MMM DD, YYYY\"),\r\n    },\r\n  ];\r\n\r\n  const pendingRequests = assignRequests.filter((r) => r.status === 0);\r\n  const completedSessions = gradingSessions.filter((s) => s.status === 1);\r\n  const processingSessions = gradingSessions.filter((s) => s.status === 0);\r\n  const failedSessions = gradingSessions.filter((s) => s.status === 2);\r\n\r\n  return (\r\n    <Space direction=\"vertical\" size=\"large\" style={{ width: \"100%\" }}>\r\n      {/* Export Button Header */}\r\n      <Card>\r\n        <Space style={{ width: \"100%\", justifyContent: \"space-between\" }}>\r\n          <Title level={4} style={{ margin: 0 }}>Grading Dashboard</Title>\r\n          <Button\r\n            icon={<FileExcelOutlined />}\r\n            onClick={handleExportExcel}\r\n            loading={exportLoading}\r\n            type=\"primary\"\r\n            size=\"large\"\r\n          >\r\n            Export All Data to Excel\r\n          </Button>\r\n        </Space>\r\n      </Card>\r\n\r\n      {/* Grading Statistics Overview */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Grading Statistics Overview</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Grading Groups\"\r\n                value={overview.grading.totalGradingGroups}\r\n                prefix={<TeamOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Total Sessions\"\r\n                value={overview.grading.totalGradingSessions}\r\n                prefix={<FileTextOutlined />}\r\n                valueStyle={{ color: COLORS.cyan }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Completed Sessions\"\r\n                value={overview.grading.completedGradingSessions}\r\n                prefix={<CheckCircleOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Pending Requests\"\r\n                value={overview.grading.pendingAssignRequests}\r\n                prefix={<WarningOutlined />}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n        <Row gutter={[16, 16]} style={{ marginTop: 16 }}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Processing Sessions\"\r\n                value={overview.grading.gradingSessionsByStatus?.processing || processingSessions.length}\r\n                prefix={<ThunderboltOutlined />}\r\n                valueStyle={{ color: COLORS.orange }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Failed Sessions\"\r\n                value={overview.grading.gradingSessionsByStatus?.failed || failedSessions.length}\r\n                prefix={<WarningOutlined />}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Completion Rate\"\r\n                value={\r\n                  gradingSessions.length > 0\r\n                    ? Math.round((completedSessions.length / gradingSessions.length) * 100)\r\n                    : 0\r\n                }\r\n                suffix=\"%\"\r\n                prefix={<TrophyOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n              <Progress\r\n                percent={\r\n                  gradingSessions.length > 0\r\n                    ? Math.round((completedSessions.length / gradingSessions.length) * 100)\r\n                    : 0\r\n                }\r\n                size=\"small\"\r\n                style={{ marginTop: 8 }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Average Grading Time\"\r\n                value={overview.grading.averageGradingTime || 0}\r\n                suffix=\"hours\"\r\n                precision={1}\r\n                prefix={<ClockCircleOutlined />}\r\n                valueStyle={{ color: COLORS.purple }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Grading Sessions by Type */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Grading Sessions by Type</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={8}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"AI Grading\"\r\n                value={overview.grading.gradingSessionsByType?.ai || 0}\r\n                prefix={<RobotOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={8}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Lecturer Grading\"\r\n                value={overview.grading.gradingSessionsByType?.lecturer || 0}\r\n                prefix={<SolutionOutlined />}\r\n                valueStyle={{ color: COLORS.purple }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={8}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Both (AI + Lecturer)\"\r\n                value={overview.grading.gradingSessionsByType?.both || 0}\r\n                prefix={<BarChartOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Grading Groups by Status */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Grading Groups by Status</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Active Groups\"\r\n                value={overview.grading.gradingGroupsByStatus?.active || 0}\r\n                prefix={<CheckCircleOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Completed Groups\"\r\n                value={overview.grading.gradingGroupsByStatus?.completed || 0}\r\n                prefix={<TrophyOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Charts */}\r\n      <Row gutter={[16, 16]}>\r\n        <Col xs={24} lg={12}>\r\n          <Card title=\"Grading Performance (Last 30 Days)\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <LineChart data={chartData?.gradingPerformance || []}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"date\" />\r\n                <YAxis />\r\n                <RechartsTooltip />\r\n                <Legend />\r\n                <Line\r\n                  type=\"monotone\"\r\n                  dataKey=\"graded\"\r\n                  stroke={COLORS.green}\r\n                  name=\"Graded\"\r\n                />\r\n                <Line\r\n                  type=\"monotone\"\r\n                  dataKey=\"pending\"\r\n                  stroke={COLORS.orange}\r\n                  name=\"Pending\"\r\n                />\r\n              </LineChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n\r\n        <Col xs={24} lg={12}>\r\n          <Card title=\"Session Status Distribution\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <BarChart\r\n                data={[\r\n                  { name: \"Completed\", value: completedSessions.length },\r\n                  { name: \"Processing\", value: processingSessions.length },\r\n                  { name: \"Failed\", value: failedSessions.length },\r\n                ]}\r\n              >\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"name\" />\r\n                <YAxis />\r\n                <RechartsTooltip />\r\n                <Bar dataKey=\"value\" fill={COLORS.blue} />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Grading Groups Table */}\r\n      <Card\r\n        title=\"Grading Groups\"\r\n        loading={gradingGroupsLoading}\r\n        extra={\r\n          <Space>\r\n            <RangePicker\r\n              placeholder={[\"Start Date\", \"End Date\"]}\r\n              value={groupDateRange}\r\n              onChange={(dates) => setGroupDateRange(dates as [Dayjs | null, Dayjs | null] | null)}\r\n              style={{ width: 250 }}\r\n              allowClear\r\n            />\r\n          </Space>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: \"100%\", marginBottom: 16 }}>\r\n          <Search\r\n            placeholder=\"Search by lecturer name, code, or assessment template\"\r\n            allowClear\r\n            enterButton={<SearchOutlined />}\r\n            size=\"large\"\r\n            value={groupSearch}\r\n            onChange={(e) => setGroupSearch(e.target.value)}\r\n            onSearch={setGroupSearch}\r\n          />\r\n          <Text type=\"secondary\">\r\n            Showing {filteredGradingGroups.length} of {gradingGroups.length} grading groups\r\n          </Text>\r\n        </Space>\r\n        <Table\r\n          columns={gradingGroupColumns}\r\n          dataSource={filteredGradingGroups}\r\n          rowKey=\"id\"\r\n          pagination={{ pageSize: 10, showTotal: (total) => `Total ${total} grading groups` }}\r\n          scroll={{ x: 800 }}\r\n        />\r\n      </Card>\r\n\r\n      {/* Grading Sessions Table */}\r\n      <Card\r\n        title=\"Grading Sessions\"\r\n        loading={sessionsLoading}\r\n        extra={\r\n          <Space>\r\n            <Select\r\n              placeholder=\"Filter by Status\"\r\n              allowClear\r\n              style={{ width: 150 }}\r\n              value={selectedSessionStatus}\r\n              onChange={setSelectedSessionStatus}\r\n              suffixIcon={<FilterOutlined />}\r\n            >\r\n              <Select.Option value={0}>Processing</Select.Option>\r\n              <Select.Option value={1}>Completed</Select.Option>\r\n              <Select.Option value={2}>Failed</Select.Option>\r\n            </Select>\r\n            <Select\r\n              placeholder=\"Filter by Type\"\r\n              allowClear\r\n              style={{ width: 150 }}\r\n              value={selectedSessionType}\r\n              onChange={setSelectedSessionType}\r\n              suffixIcon={<FilterOutlined />}\r\n            >\r\n              <Select.Option value={0}>AI</Select.Option>\r\n              <Select.Option value={1}>Lecturer</Select.Option>\r\n              <Select.Option value={2}>Both</Select.Option>\r\n            </Select>\r\n            <RangePicker\r\n              placeholder={[\"Start Date\", \"End Date\"]}\r\n              value={sessionDateRange}\r\n              onChange={(dates) => setSessionDateRange(dates as [Dayjs | null, Dayjs | null] | null)}\r\n              style={{ width: 250 }}\r\n              allowClear\r\n            />\r\n          </Space>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: \"100%\", marginBottom: 16 }}>\r\n          <Search\r\n            placeholder=\"Search by student name or code\"\r\n            allowClear\r\n            enterButton={<SearchOutlined />}\r\n            size=\"large\"\r\n            value={sessionSearch}\r\n            onChange={(e) => setSessionSearch(e.target.value)}\r\n            onSearch={setSessionSearch}\r\n          />\r\n          <Text type=\"secondary\">\r\n            Showing {filteredGradingSessions.length} of {gradingSessions.length} grading sessions\r\n          </Text>\r\n        </Space>\r\n        <Table\r\n          columns={sessionColumns}\r\n          dataSource={filteredGradingSessions}\r\n          rowKey=\"id\"\r\n          pagination={{ pageSize: 20, showTotal: (total) => `Total ${total} grading sessions` }}\r\n          scroll={{ x: 1000 }}\r\n        />\r\n      </Card>\r\n\r\n      {/* Assign Requests Table */}\r\n      <Card\r\n        title=\"Assign Requests\"\r\n        loading={requestsLoading}\r\n        extra={\r\n          <Space>\r\n            <Select\r\n              placeholder=\"Filter by Status\"\r\n              allowClear\r\n              style={{ width: 150 }}\r\n              value={selectedRequestStatus}\r\n              onChange={setSelectedRequestStatus}\r\n              suffixIcon={<FilterOutlined />}\r\n            >\r\n              <Select.Option value={0}>Pending</Select.Option>\r\n              <Select.Option value={1}>Approved</Select.Option>\r\n              <Select.Option value={2}>Rejected</Select.Option>\r\n            </Select>\r\n            <RangePicker\r\n              placeholder={[\"Start Date\", \"End Date\"]}\r\n              value={requestDateRange}\r\n              onChange={(dates) => setRequestDateRange(dates as [Dayjs | null, Dayjs | null] | null)}\r\n              style={{ width: 250 }}\r\n              allowClear\r\n            />\r\n          </Space>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: \"100%\", marginBottom: 16 }}>\r\n          <Search\r\n            placeholder=\"Search by course element, course, lecturer, or HOD\"\r\n            allowClear\r\n            enterButton={<SearchOutlined />}\r\n            size=\"large\"\r\n            value={requestSearch}\r\n            onChange={(e) => setRequestSearch(e.target.value)}\r\n            onSearch={setRequestSearch}\r\n          />\r\n          <Text type=\"secondary\">\r\n            Showing {filteredAssignRequests.length} of {assignRequests.length} assign requests\r\n          </Text>\r\n        </Space>\r\n        <Table\r\n          columns={requestColumns}\r\n          dataSource={filteredAssignRequests}\r\n          rowKey=\"id\"\r\n          pagination={{ pageSize: 10, showTotal: (total) => `Total ${total} assign requests` }}\r\n          scroll={{ x: 1000 }}\r\n        />\r\n      </Card>\r\n    </Space>\r\n  );\r\n};\r\n\r\nexport default GradingTab;\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/app/admin/dashboard/components/GradingTab.tsx b/src/app/admin/dashboard/components/GradingTab.tsx
--- a/src/app/admin/dashboard/components/GradingTab.tsx	(revision 6f9873a8330481f7416524ce2b29e489e3f5c3fa)
+++ b/src/app/admin/dashboard/components/GradingTab.tsx	(date 1763996951209)
@@ -512,96 +512,96 @@
       {/* Grading Statistics Overview */}
       <Card>
         <Title level={5} style={{ marginBottom: 16 }}>Grading Statistics Overview</Title>
-        <Row gutter={[16, 16]}>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Grading Groups"
-                value={overview.grading.totalGradingGroups}
+      <Row gutter={[16, 16]}>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Grading Groups"
+              value={overview.grading.totalGradingGroups}
                 prefix={<TeamOutlined />}
-                valueStyle={{ color: COLORS.blue }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+              valueStyle={{ color: COLORS.blue }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Total Sessions"
-                value={overview.grading.totalGradingSessions}
-                prefix={<FileTextOutlined />}
-                valueStyle={{ color: COLORS.cyan }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Completed Sessions"
-                value={overview.grading.completedGradingSessions}
-                prefix={<CheckCircleOutlined />}
-                valueStyle={{ color: COLORS.green }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Pending Requests"
-                value={overview.grading.pendingAssignRequests}
+              value={overview.grading.totalGradingSessions}
+              prefix={<FileTextOutlined />}
+              valueStyle={{ color: COLORS.cyan }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Completed Sessions"
+              value={overview.grading.completedGradingSessions}
+              prefix={<CheckCircleOutlined />}
+              valueStyle={{ color: COLORS.green }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Pending Requests"
+              value={overview.grading.pendingAssignRequests}
                 prefix={<WarningOutlined />}
-                valueStyle={{ color: COLORS.red }}
-              />
-            </Card>
-          </Col>
-        </Row>
+              valueStyle={{ color: COLORS.red }}
+            />
+          </Card>
+        </Col>
+      </Row>
         <Row gutter={[16, 16]} style={{ marginTop: 16 }}>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Processing Sessions"
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Processing Sessions"
                 value={overview.grading.gradingSessionsByStatus?.processing || processingSessions.length}
                 prefix={<ThunderboltOutlined />}
-                valueStyle={{ color: COLORS.orange }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Failed Sessions"
+              valueStyle={{ color: COLORS.orange }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Failed Sessions"
                 value={overview.grading.gradingSessionsByStatus?.failed || failedSessions.length}
                 prefix={<WarningOutlined />}
-                valueStyle={{ color: COLORS.red }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Completion Rate"
-                value={
-                  gradingSessions.length > 0
-                    ? Math.round((completedSessions.length / gradingSessions.length) * 100)
-                    : 0
-                }
-                suffix="%"
+              valueStyle={{ color: COLORS.red }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Completion Rate"
+              value={
+                gradingSessions.length > 0
+                  ? Math.round((completedSessions.length / gradingSessions.length) * 100)
+                  : 0
+              }
+              suffix="%"
                 prefix={<TrophyOutlined />}
-                valueStyle={{ color: COLORS.green }}
-              />
-              <Progress
-                percent={
-                  gradingSessions.length > 0
-                    ? Math.round((completedSessions.length / gradingSessions.length) * 100)
-                    : 0
-                }
-                size="small"
+              valueStyle={{ color: COLORS.green }}
+            />
+            <Progress
+              percent={
+                gradingSessions.length > 0
+                  ? Math.round((completedSessions.length / gradingSessions.length) * 100)
+                  : 0
+              }
+              size="small"
                 style={{ marginTop: 8 }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Average Grading Time"
                 value={overview.grading.averageGradingTime || 0}
                 suffix="hours"
@@ -624,10 +624,10 @@
                 title="AI Grading"
                 value={overview.grading.gradingSessionsByType?.ai || 0}
                 prefix={<RobotOutlined />}
-                valueStyle={{ color: COLORS.blue }}
-              />
-            </Card>
-          </Col>
+              valueStyle={{ color: COLORS.blue }}
+            />
+          </Card>
+        </Col>
           <Col xs={24} sm={12} lg={8}>
             <Card>
               <Statistic
@@ -648,7 +648,7 @@
               />
             </Card>
           </Col>
-        </Row>
+      </Row>
       </Card>
 
       {/* Grading Groups by Status */}
Index: src/app/admin/dashboard/components/SubmissionsTab.tsx
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\"use client\";\r\n\r\nimport React, { useEffect, useState, useMemo } from \"react\";\r\nimport { Card, Row, Col, Statistic, Table, Tag, Typography, Space, Progress, Input, Select, DatePicker, Button, App } from \"antd\";\r\nimport {\r\n  UploadOutlined,\r\n  CheckCircleOutlined,\r\n  ClockCircleOutlined,\r\n  FileTextOutlined,\r\n  UserOutlined,\r\n  SearchOutlined,\r\n  FilterOutlined,\r\n  FileExcelOutlined,\r\n  TrophyOutlined,\r\n  ExperimentOutlined,\r\n  WarningOutlined,\r\n  RiseOutlined,\r\n  BarChartOutlined,\r\n} from \"@ant-design/icons\";\r\nimport { Dayjs } from \"dayjs\";\r\nimport * as XLSX from \"xlsx\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip as RechartsTooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\nimport { submissionService } from \"@/services/submissionService\";\r\nimport type { DashboardOverview, ChartData } from \"@/services/adminDashboardService\";\r\nimport dayjs from \"dayjs\";\r\n\r\nconst { Title, Text } = Typography;\r\nconst { Search } = Input;\r\nconst { RangePicker } = DatePicker;\r\n\r\nconst COLORS = {\r\n  blue: \"#2563EB\",\r\n  green: \"#10B981\",\r\n  purple: \"#6D28D9\",\r\n  orange: \"#F59E0B\",\r\n  red: \"#EF4444\",\r\n  cyan: \"#06B6D4\",\r\n};\r\n\r\nconst CHART_COLORS = [\"#2563EB\", \"#10B981\", \"#6D28D9\", \"#F59E0B\", \"#EF4444\"];\r\n\r\ninterface SubmissionsTabProps {\r\n  overview: DashboardOverview | null;\r\n  chartData: ChartData | null;\r\n  loading: boolean;\r\n  onRefresh: () => void;\r\n}\r\n\r\nconst SubmissionsTab: React.FC<SubmissionsTabProps> = ({\r\n  overview,\r\n  chartData,\r\n  loading,\r\n}) => {\r\n  const { message } = App.useApp();\r\n  const [submissions, setSubmissions] = useState<any[]>([]);\r\n  const [submissionsLoading, setSubmissionsLoading] = useState(false);\r\n  const [searchText, setSearchText] = useState(\"\");\r\n  const [selectedStatus, setSelectedStatus] = useState<string | undefined>(undefined);\r\n  const [dateRange, setDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\r\n  const [exportLoading, setExportLoading] = useState(false);\r\n\r\n  const handleExportExcel = () => {\r\n    if (!overview) {\r\n      message.warning(\"No data available to export\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setExportLoading(true);\r\n      const wb = XLSX.utils.book_new();\r\n\r\n      // All Statistics Cards Sheet\r\n      const statsData = [\r\n        [\"Metric\", \"Value\"],\r\n        [\"Total Submissions\", overview.submissions.total],\r\n        [\"Graded\", overview.submissions.graded],\r\n        [\"Pending Grading\", overview.submissions.pending],\r\n        [\"Not Submitted\", overview.submissions.notSubmitted],\r\n        [\"Completion Rate (%)\", overview.submissions.completionRate],\r\n        [\"Grading Rate (%)\", overview.submissions.total > 0 ? Math.round((overview.submissions.graded / overview.submissions.total) * 100) : 0],\r\n        [\"Pending Rate (%)\", overview.submissions.total > 0 ? Math.round((overview.submissions.pending / overview.submissions.total) * 100) : 0],\r\n        [\"Average Grade\", overview.submissions.graded > 0 ? (submissions.filter((s) => s.lastGrade > 0).reduce((sum, s) => sum + s.lastGrade, 0) / overview.submissions.graded).toFixed(2) : 0],\r\n        [\"Late Submissions\", overview.submissions.lateSubmissions || 0],\r\n        [\"On-Time Submissions\", overview.submissions.onTimeSubmissions || 0],\r\n        [\"Assignments\", overview.submissions.submissionsByType?.assignment || 0],\r\n        [\"Labs\", overview.submissions.submissionsByType?.lab || 0],\r\n        [\"Practical Exams\", overview.submissions.submissionsByType?.practicalExam || 0],\r\n      ];\r\n      const ws1 = XLSX.utils.aoa_to_sheet(statsData);\r\n      XLSX.utils.book_append_sheet(wb, ws1, \"Statistics\");\r\n\r\n      // Submission Status Distribution (Pie Chart Data)\r\n      const pieChartData = submissionStatusData.map((item) => ({\r\n        Status: item.name,\r\n        Count: item.value,\r\n        Percentage: overview.submissions.total > 0 ? ((item.value / overview.submissions.total) * 100).toFixed(2) + \"%\" : \"0%\",\r\n      }));\r\n      const ws2 = XLSX.utils.json_to_sheet(pieChartData);\r\n      XLSX.utils.book_append_sheet(wb, ws2, \"Status Distribution\");\r\n\r\n      // Submission Status Bar Chart Data\r\n      if (chartData?.submissionStatus && chartData.submissionStatus.length > 0) {\r\n        const barChartData = chartData.submissionStatus.map((item) => ({\r\n          Status: item.status,\r\n          Count: item.count,\r\n        }));\r\n        const ws3 = XLSX.utils.json_to_sheet(barChartData);\r\n        XLSX.utils.book_append_sheet(wb, ws3, \"Status Bar Chart\");\r\n      }\r\n\r\n      // Submissions Over Time (Line Chart Data - Last 30 Days)\r\n      if (submissionsChartData && submissionsChartData.length > 0) {\r\n        const lineChartData = submissionsChartData.map((item: any) => ({\r\n          Date: item.date,\r\n          \"Total Submissions\": item.count,\r\n          Graded: item.graded,\r\n        }));\r\n        const ws4 = XLSX.utils.json_to_sheet(lineChartData);\r\n        XLSX.utils.book_append_sheet(wb, ws4, \"Submissions Over Time\");\r\n      }\r\n\r\n      // All Submissions Table (Filtered)\r\n      const submissionsData = filteredSubmissions.map((sub, index) => ({\r\n        \"No\": index + 1,\r\n        \"ID\": sub.id,\r\n        \"Student Name\": sub.studentName || \"\",\r\n        \"Student Code\": sub.studentCode || \"\",\r\n        \"Submitted At\": sub.submittedAt ? dayjs(sub.submittedAt).format(\"YYYY-MM-DD HH:mm\") : \"Not submitted\",\r\n        \"Last Grade\": sub.lastGrade || 0,\r\n        \"Status\": sub.lastGrade > 0 ? \"Graded\" : sub.submittedAt ? \"Pending\" : \"Not Submitted\",\r\n        \"Has File\": sub.submissionFile ? \"Yes\" : \"No\",\r\n      }));\r\n      const ws5 = XLSX.utils.json_to_sheet(submissionsData);\r\n      XLSX.utils.book_append_sheet(wb, ws5, \"All Submissions\");\r\n\r\n      // Top Students Sheet\r\n      if (overview.submissions.topStudentsBySubmissions && overview.submissions.topStudentsBySubmissions.length > 0) {\r\n        const topStudentsData = overview.submissions.topStudentsBySubmissions.map((student, index) => ({\r\n          \"Rank\": index + 1,\r\n          \"Student Code\": student.studentCode,\r\n          \"Student Name\": student.studentName,\r\n          \"Submissions\": student.submissionCount,\r\n          \"Average Grade\": student.averageGrade?.toFixed(2) || 0,\r\n        }));\r\n        const ws6 = XLSX.utils.json_to_sheet(topStudentsData);\r\n        XLSX.utils.book_append_sheet(wb, ws6, \"Top Students\");\r\n      }\r\n\r\n      // Submissions by Day Sheet\r\n      if (overview.submissions.submissionsByDay && overview.submissions.submissionsByDay.length > 0) {\r\n        const byDayData = overview.submissions.submissionsByDay.map((item) => ({\r\n          Date: item.date,\r\n          Count: item.count,\r\n        }));\r\n        const ws7 = XLSX.utils.json_to_sheet(byDayData);\r\n        XLSX.utils.book_append_sheet(wb, ws7, \"Submissions by Day\");\r\n      }\r\n\r\n      const fileName = `Submissions_Dashboard_${dayjs().format(\"YYYY-MM-DD\")}.xlsx`;\r\n      XLSX.writeFile(wb, fileName);\r\n      message.success(`Exported all submissions data successfully`);\r\n    } catch (error) {\r\n      console.error(\"Export error:\", error);\r\n      message.error(\"Failed to export submissions data\");\r\n    } finally {\r\n      setExportLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchSubmissions();\r\n  }, []);\r\n\r\n  const fetchSubmissions = async () => {\r\n    try {\r\n      setSubmissionsLoading(true);\r\n      const submissionsData = await submissionService.getSubmissionList({});\r\n      setSubmissions(submissionsData);\r\n    } catch (error) {\r\n      console.error(\"Error fetching submissions:\", error);\r\n    } finally {\r\n      setSubmissionsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Filter submissions\r\n  const filteredSubmissions = useMemo(() => {\r\n    let filtered = [...submissions];\r\n\r\n    if (searchText) {\r\n      const searchLower = searchText.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (sub) =>\r\n          sub.studentName?.toLowerCase().includes(searchLower) ||\r\n          sub.studentCode?.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    if (selectedStatus) {\r\n      if (selectedStatus === \"graded\") {\r\n        filtered = filtered.filter((sub) => sub.lastGrade > 0);\r\n      } else if (selectedStatus === \"pending\") {\r\n        filtered = filtered.filter((sub) => sub.lastGrade === 0 && sub.submittedAt);\r\n      } else if (selectedStatus === \"not_submitted\") {\r\n        filtered = filtered.filter((sub) => !sub.submittedAt);\r\n      }\r\n    }\r\n\r\n    if (dateRange && dateRange[0] && dateRange[1]) {\r\n      filtered = filtered.filter((sub) => {\r\n        if (!sub.submittedAt) return false;\r\n        const submittedDate = dayjs(sub.submittedAt);\r\n        const startDate = dateRange[0]!.startOf(\"day\");\r\n        const endDate = dateRange[1]!.endOf(\"day\");\r\n        return (\r\n          (submittedDate.isAfter(startDate) || submittedDate.isSame(startDate)) &&\r\n          (submittedDate.isBefore(endDate) || submittedDate.isSame(endDate))\r\n        );\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [submissions, searchText, selectedStatus, dateRange]);\r\n\r\n  if (!overview) return null;\r\n\r\n  const submissionStatusData = [\r\n    { name: \"Graded\", value: overview.submissions.graded, color: COLORS.green },\r\n    { name: \"Pending\", value: overview.submissions.pending, color: COLORS.orange },\r\n    { name: \"Not Submitted\", value: overview.submissions.notSubmitted, color: COLORS.red },\r\n  ];\r\n\r\n  const submissionColumns = [\r\n    {\r\n      title: \"ID\",\r\n      dataIndex: \"id\",\r\n      key: \"id\",\r\n      width: 80,\r\n    },\r\n    {\r\n      title: \"Student\",\r\n      key: \"student\",\r\n      render: (_: any, record: any) => (\r\n        <Space>\r\n          <UserOutlined />\r\n          <span>{record.studentName} ({record.studentCode})</span>\r\n        </Space>\r\n      ),\r\n    },\r\n    {\r\n      title: \"Submitted At\",\r\n      dataIndex: \"submittedAt\",\r\n      key: \"submittedAt\",\r\n      render: (date: string) => date ? dayjs(date).format(\"MMM DD, YYYY HH:mm\") : \"Not submitted\",\r\n    },\r\n    {\r\n      title: \"Grade\",\r\n      dataIndex: \"lastGrade\",\r\n      key: \"lastGrade\",\r\n      render: (grade: number) => (\r\n        <Tag color={grade > 0 ? \"green\" : \"default\"}>\r\n          {grade > 0 ? grade.toFixed(2) : \"Not graded\"}\r\n        </Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: \"Status\",\r\n      key: \"status\",\r\n      render: (_: any, record: any) => {\r\n        if (!record.submittedAt) {\r\n          return <Tag color=\"red\">Not Submitted</Tag>;\r\n        }\r\n        if (record.lastGrade > 0) {\r\n          return <Tag color=\"green\">Graded</Tag>;\r\n        }\r\n        return <Tag color=\"orange\">Pending</Tag>;\r\n      },\r\n    },\r\n    {\r\n      title: \"File\",\r\n      dataIndex: \"submissionFile\",\r\n      key: \"submissionFile\",\r\n      render: (file: any) => (\r\n        file ? (\r\n          <Tag color=\"blue\">Yes</Tag>\r\n        ) : (\r\n          <Tag>No</Tag>\r\n        )\r\n      ),\r\n    },\r\n  ];\r\n\r\n  // Group submissions by date for chart\r\n  const submissionsByDate = submissions.reduce((acc: any, sub: any) => {\r\n    if (sub.submittedAt) {\r\n      const date = dayjs(sub.submittedAt).format(\"YYYY-MM-DD\");\r\n      if (!acc[date]) {\r\n        acc[date] = { date, count: 0, graded: 0 };\r\n      }\r\n      acc[date].count++;\r\n      if (sub.lastGrade > 0) {\r\n        acc[date].graded++;\r\n      }\r\n    }\r\n    return acc;\r\n  }, {});\r\n\r\n  const submissionsChartData = Object.values(submissionsByDate)\r\n    .sort((a: any, b: any) => a.date.localeCompare(b.date))\r\n    .slice(-30); // Last 30 days\r\n\r\n  return (\r\n    <Space direction=\"vertical\" size=\"large\" style={{ width: \"100%\" }}>\r\n      {/* Export Button Header */}\r\n      <Card>\r\n        <Space style={{ width: \"100%\", justifyContent: \"space-between\" }}>\r\n          <Title level={4} style={{ margin: 0 }}>Submissions Dashboard</Title>\r\n          <Button\r\n            icon={<FileExcelOutlined />}\r\n            onClick={handleExportExcel}\r\n            loading={exportLoading}\r\n            type=\"primary\"\r\n            size=\"large\"\r\n          >\r\n            Export All Data to Excel\r\n          </Button>\r\n        </Space>\r\n      </Card>\r\n\r\n      {/* Submission Statistics Overview */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Submission Statistics Overview</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Total Submissions\"\r\n                value={overview.submissions.total}\r\n                prefix={<UploadOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Graded\"\r\n                value={overview.submissions.graded}\r\n                prefix={<CheckCircleOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Pending Grading\"\r\n                value={overview.submissions.pending}\r\n                prefix={<ClockCircleOutlined />}\r\n                valueStyle={{ color: COLORS.orange }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Completion Rate\"\r\n                value={overview.submissions.completionRate}\r\n                suffix=\"%\"\r\n                prefix={<FileTextOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n              <Progress\r\n                percent={overview.submissions.completionRate}\r\n                size=\"small\"\r\n                style={{ marginTop: \"8px\" }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n        <Row gutter={[16, 16]} style={{ marginTop: 16 }}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Average Grade\"\r\n                value={overview.submissions.averageGrade || 0}\r\n                precision={2}\r\n                prefix={<TrophyOutlined />}\r\n                valueStyle={{ color: COLORS.purple }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"On-Time Submissions\"\r\n                value={overview.submissions.onTimeSubmissions || 0}\r\n                prefix={<CheckCircleOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Late Submissions\"\r\n                value={overview.submissions.lateSubmissions || 0}\r\n                prefix={<WarningOutlined />}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Not Submitted\"\r\n                value={overview.submissions.notSubmitted || 0}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Submission by Type */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Submissions by Type</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={8}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Assignments\"\r\n                value={overview.submissions.submissionsByType?.assignment || 0}\r\n                prefix={<FileTextOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={8}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Labs\"\r\n                value={overview.submissions.submissionsByType?.lab || 0}\r\n                prefix={<ExperimentOutlined />}\r\n                valueStyle={{ color: COLORS.cyan }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={8}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Practical Exams\"\r\n                value={overview.submissions.submissionsByType?.practicalExam || 0}\r\n                prefix={<BarChartOutlined />}\r\n                valueStyle={{ color: COLORS.orange }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Grade Distribution */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Grade Distribution</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Excellent (8.5)\"\r\n                value={overview.submissions.submissionsByGradeRange?.excellent || 0}\r\n                prefix={<TrophyOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Good (7.0-8.4)\"\r\n                value={overview.submissions.submissionsByGradeRange?.good || 0}\r\n                prefix={<RiseOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Average (5.5-6.9)\"\r\n                value={overview.submissions.submissionsByGradeRange?.average || 0}\r\n                prefix={<BarChartOutlined />}\r\n                valueStyle={{ color: COLORS.orange }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Below Average (<5.5)\"\r\n                value={overview.submissions.submissionsByGradeRange?.belowAverage || 0}\r\n                prefix={<WarningOutlined />}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Charts */}\r\n      <Row gutter={[16, 16]}>\r\n        <Col xs={24} lg={12}>\r\n          <Card title=\"Submission Status Distribution\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <PieChart>\r\n                <Pie\r\n                  data={submissionStatusData}\r\n                  cx=\"50%\"\r\n                  cy=\"50%\"\r\n                  labelLine={false}\r\n                  label={(entry: any) =>\r\n                    `${entry.name} ${(entry.percent * 100).toFixed(0)}%`\r\n                  }\r\n                  outerRadius={80}\r\n                  fill=\"#8884d8\"\r\n                  dataKey=\"value\"\r\n                >\r\n                  {submissionStatusData.map((entry, index) => (\r\n                    <Cell key={`cell-${index}`} fill={entry.color} />\r\n                  ))}\r\n                </Pie>\r\n                <RechartsTooltip />\r\n              </PieChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n\r\n        <Col xs={24} lg={12}>\r\n          <Card title=\"Submission Status (Bar Chart)\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <BarChart data={chartData?.submissionStatus || []}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"status\" />\r\n                <YAxis />\r\n                <RechartsTooltip />\r\n                <Bar dataKey=\"count\" fill={COLORS.blue} />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      <Row gutter={[16, 16]}>\r\n        <Col xs={24}>\r\n          <Card title=\"Submissions Over Time (Last 30 Days)\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <LineChart data={submissionsChartData}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"date\" />\r\n                <YAxis />\r\n                <RechartsTooltip />\r\n                <Legend />\r\n                <Line\r\n                  type=\"monotone\"\r\n                  dataKey=\"count\"\r\n                  stroke={COLORS.blue}\r\n                  name=\"Total Submissions\"\r\n                />\r\n                <Line\r\n                  type=\"monotone\"\r\n                  dataKey=\"graded\"\r\n                  stroke={COLORS.green}\r\n                  name=\"Graded\"\r\n                />\r\n              </LineChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Submissions Table */}\r\n      <Card\r\n        title=\"All Submissions\"\r\n        loading={submissionsLoading}\r\n        extra={\r\n          <Space>\r\n            <Select\r\n              placeholder=\"Filter by Status\"\r\n              allowClear\r\n              style={{ width: 150 }}\r\n              value={selectedStatus}\r\n              onChange={setSelectedStatus}\r\n              suffixIcon={<FilterOutlined />}\r\n            >\r\n              <Select.Option value=\"graded\">Graded</Select.Option>\r\n              <Select.Option value=\"pending\">Pending</Select.Option>\r\n              <Select.Option value=\"not_submitted\">Not Submitted</Select.Option>\r\n            </Select>\r\n            <RangePicker\r\n              placeholder={[\"Start Date\", \"End Date\"]}\r\n              value={dateRange}\r\n              onChange={(dates) => setDateRange(dates as [Dayjs | null, Dayjs | null] | null)}\r\n              style={{ width: 250 }}\r\n              allowClear\r\n            />\r\n          </Space>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: \"100%\", marginBottom: 16 }}>\r\n          <Search\r\n            placeholder=\"Search by student name or code\"\r\n            allowClear\r\n            enterButton={<SearchOutlined />}\r\n            size=\"large\"\r\n            value={searchText}\r\n            onChange={(e) => setSearchText(e.target.value)}\r\n            onSearch={setSearchText}\r\n          />\r\n          <Text type=\"secondary\">\r\n            Showing {filteredSubmissions.length} of {submissions.length} submissions\r\n          </Text>\r\n        </Space>\r\n        <Table\r\n          columns={submissionColumns}\r\n          dataSource={filteredSubmissions}\r\n          rowKey=\"id\"\r\n          pagination={{ pageSize: 20, showTotal: (total) => `Total ${total} submissions` }}\r\n          scroll={{ x: 1000 }}\r\n        />\r\n      </Card>\r\n    </Space>\r\n  );\r\n};\r\n\r\nexport default SubmissionsTab;\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/app/admin/dashboard/components/SubmissionsTab.tsx b/src/app/admin/dashboard/components/SubmissionsTab.tsx
--- a/src/app/admin/dashboard/components/SubmissionsTab.tsx	(revision 6f9873a8330481f7416524ce2b29e489e3f5c3fa)
+++ b/src/app/admin/dashboard/components/SubmissionsTab.tsx	(date 1763996951174)
@@ -344,54 +344,54 @@
       {/* Submission Statistics Overview */}
       <Card>
         <Title level={5} style={{ marginBottom: 16 }}>Submission Statistics Overview</Title>
-        <Row gutter={[16, 16]}>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Total Submissions"
-                value={overview.submissions.total}
-                prefix={<UploadOutlined />}
-                valueStyle={{ color: COLORS.blue }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Graded"
-                value={overview.submissions.graded}
-                prefix={<CheckCircleOutlined />}
-                valueStyle={{ color: COLORS.green }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Pending Grading"
-                value={overview.submissions.pending}
-                prefix={<ClockCircleOutlined />}
-                valueStyle={{ color: COLORS.orange }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Completion Rate"
-                value={overview.submissions.completionRate}
-                suffix="%"
-                prefix={<FileTextOutlined />}
-                valueStyle={{ color: COLORS.green }}
-              />
-              <Progress
-                percent={overview.submissions.completionRate}
-                size="small"
-                style={{ marginTop: "8px" }}
-              />
-            </Card>
-          </Col>
-        </Row>
+      <Row gutter={[16, 16]}>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Total Submissions"
+              value={overview.submissions.total}
+              prefix={<UploadOutlined />}
+              valueStyle={{ color: COLORS.blue }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Graded"
+              value={overview.submissions.graded}
+              prefix={<CheckCircleOutlined />}
+              valueStyle={{ color: COLORS.green }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Pending Grading"
+              value={overview.submissions.pending}
+              prefix={<ClockCircleOutlined />}
+              valueStyle={{ color: COLORS.orange }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Completion Rate"
+              value={overview.submissions.completionRate}
+              suffix="%"
+              prefix={<FileTextOutlined />}
+              valueStyle={{ color: COLORS.green }}
+            />
+            <Progress
+              percent={overview.submissions.completionRate}
+              size="small"
+              style={{ marginTop: "8px" }}
+            />
+          </Card>
+        </Col>
+      </Row>
         <Row gutter={[16, 16]} style={{ marginTop: 16 }}>
           <Col xs={24} sm={12} lg={6}>
             <Card>
@@ -414,19 +414,19 @@
               />
             </Card>
           </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Late Submissions"
                 value={overview.submissions.lateSubmissions || 0}
                 prefix={<WarningOutlined />}
-                valueStyle={{ color: COLORS.red }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+              valueStyle={{ color: COLORS.red }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Not Submitted"
                 value={overview.submissions.notSubmitted || 0}
                 valueStyle={{ color: COLORS.red }}
@@ -483,8 +483,8 @@
                 title="Excellent (8.5)"
                 value={overview.submissions.submissionsByGradeRange?.excellent || 0}
                 prefix={<TrophyOutlined />}
-                valueStyle={{ color: COLORS.green }}
-              />
+              valueStyle={{ color: COLORS.green }}
+            />
             </Card>
           </Col>
           <Col xs={24} sm={12} lg={6}>
@@ -494,30 +494,30 @@
                 value={overview.submissions.submissionsByGradeRange?.good || 0}
                 prefix={<RiseOutlined />}
                 valueStyle={{ color: COLORS.blue }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Average (5.5-6.9)"
                 value={overview.submissions.submissionsByGradeRange?.average || 0}
                 prefix={<BarChartOutlined />}
-                valueStyle={{ color: COLORS.orange }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+              valueStyle={{ color: COLORS.orange }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
                 title="Below Average (<5.5)"
                 value={overview.submissions.submissionsByGradeRange?.belowAverage || 0}
                 prefix={<WarningOutlined />}
                 valueStyle={{ color: COLORS.red }}
-              />
-            </Card>
-          </Col>
-        </Row>
+            />
+          </Card>
+        </Col>
+      </Row>
       </Card>
 
       {/* Charts */}
Index: src/app/admin/dashboard/components/UsersTab.tsx
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\"use client\";\r\n\r\nimport React, { useEffect, useState, useMemo } from \"react\";\r\nimport { Card, Row, Col, Statistic, Table, Tag, Progress, Typography, Space, Input, Select, DatePicker, Button, App } from \"antd\";\r\nimport {\r\n  UserOutlined,\r\n  TeamOutlined,\r\n  ManOutlined,\r\n  WomanOutlined,\r\n  UserAddOutlined,\r\n  CheckCircleOutlined,\r\n  SearchOutlined,\r\n  FilterOutlined,\r\n  FileExcelOutlined,\r\n  WarningOutlined,\r\n  PhoneOutlined,\r\n} from \"@ant-design/icons\";\r\nimport dayjs, { Dayjs } from \"dayjs\";\r\nimport * as XLSX from \"xlsx\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip as RechartsTooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\nimport { adminService } from \"@/services/adminService\";\r\nimport type { DashboardOverview, ChartData } from \"@/services/adminDashboardService\";\r\nimport { User } from \"@/types\";\r\n\r\nconst { Title, Text } = Typography;\r\n\r\nconst COLORS = {\r\n  blue: \"#2563EB\",\r\n  green: \"#10B981\",\r\n  purple: \"#6D28D9\",\r\n  orange: \"#F59E0B\",\r\n  red: \"#EF4444\",\r\n  cyan: \"#06B6D4\",\r\n};\r\n\r\nconst CHART_COLORS = [\"#2563EB\", \"#10B981\", \"#6D28D9\", \"#F59E0B\", \"#EF4444\"];\r\n\r\ninterface UsersTabProps {\r\n  overview: DashboardOverview | null;\r\n  chartData: ChartData | null;\r\n  loading: boolean;\r\n  onRefresh: () => void;\r\n}\r\n\r\nconst { RangePicker } = DatePicker;\r\nconst { Search } = Input;\r\n\r\nconst UsersTab: React.FC<UsersTabProps> = ({\r\n  overview,\r\n  chartData,\r\n  loading,\r\n}) => {\r\n  const { message } = App.useApp();\r\n  const [users, setUsers] = useState<any[]>([]);\r\n  const [usersLoading, setUsersLoading] = useState(false);\r\n  const [searchText, setSearchText] = useState(\"\");\r\n  const [selectedRole, setSelectedRole] = useState<number | undefined>(undefined);\r\n  const [dateRange, setDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);\r\n  const [exportLoading, setExportLoading] = useState(false);\r\n\r\n  const handleExportExcel = () => {\r\n    if (!overview) {\r\n      message.warning(\"No data available to export\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setExportLoading(true);\r\n      const wb = XLSX.utils.book_new();\r\n\r\n      // All Statistics Cards Sheet (8 cards)\r\n      const statsData = [\r\n        [\"Metric\", \"Value\"],\r\n        [\"Total Users\", overview.users.total],\r\n        [\"Active Users\", overview.users.active],\r\n        [\"New This Month\", overview.users.newThisMonth],\r\n        [\"Students\", overview.users.byRole.student],\r\n        [\"Lecturers\", overview.users.byRole.lecturer],\r\n        [\"Admins\", overview.users.byRole.admin],\r\n        [\"HODs\", overview.users.byRole.hod],\r\n        [\"Examiners\", overview.users.byRole.examiner],\r\n        [\"Active Rate (%)\", overview.users.total > 0 ? Math.round((overview.users.active / overview.users.total) * 100) : 0],\r\n        [\"Users With Avatar\", overview.users.usersWithAvatar || 0],\r\n        [\"Average Age\", overview.users.averageAge?.toFixed(1) || \"N/A\"],\r\n        [\"Male\", overview.users.byGender?.male || 0],\r\n        [\"Female\", overview.users.byGender?.female || 0],\r\n        [\"Other\", overview.users.byGender?.other || 0],\r\n      ];\r\n      const ws1 = XLSX.utils.aoa_to_sheet(statsData);\r\n      XLSX.utils.book_append_sheet(wb, ws1, \"Statistics\");\r\n\r\n      // Role Distribution Chart Data (Pie Chart)\r\n      const totalUsers = overview.users.total;\r\n      const roleData = roleDistribution.map((item) => ({\r\n        Role: item.name,\r\n        Count: item.value,\r\n        Percentage: totalUsers > 0 ? ((item.value / totalUsers) * 100).toFixed(2) + \"%\" : \"0%\",\r\n      }));\r\n      const ws2 = XLSX.utils.json_to_sheet(roleData);\r\n      XLSX.utils.book_append_sheet(wb, ws2, \"Role Distribution\");\r\n\r\n      // Gender Distribution Chart Data (Bar Chart)\r\n      const genderData = genderDistribution.map((item) => ({\r\n        Gender: item.name,\r\n        Count: item.value,\r\n        Percentage: totalUsers > 0 ? ((item.value / totalUsers) * 100).toFixed(2) + \"%\" : \"0%\",\r\n      }));\r\n      const ws3 = XLSX.utils.json_to_sheet(genderData);\r\n      XLSX.utils.book_append_sheet(wb, ws3, \"Gender Distribution\");\r\n\r\n      // User Growth Chart Data (Bar Chart - Last 12 Months)\r\n      if (chartData?.userGrowth && chartData.userGrowth.length > 0) {\r\n        const growthData = chartData.userGrowth.map((item) => ({\r\n          Month: item.month,\r\n          \"Total Users\": item.total,\r\n          Students: item.students,\r\n          Lecturers: item.lecturers,\r\n        }));\r\n        const ws4 = XLSX.utils.json_to_sheet(growthData);\r\n        XLSX.utils.book_append_sheet(wb, ws4, \"User Growth\");\r\n      }\r\n\r\n      // All Users Table (Filtered)\r\n      const roleMap: Record<number, string> = {\r\n        0: \"Admin\",\r\n        1: \"Lecturer\",\r\n        2: \"Student\",\r\n        3: \"HOD\",\r\n        4: \"Examiner\",\r\n      };\r\n      const genderMap: Record<number, string> = {\r\n        0: \"Male\",\r\n        1: \"Female\",\r\n        2: \"Other\",\r\n      };\r\n      const usersData = filteredUsers.map((user, index) => ({\r\n        \"No\": index + 1,\r\n        \"ID\": user.id,\r\n        \"Full Name\": user.fullName || \"\",\r\n        \"Email\": user.email || \"\",\r\n        \"Account Code\": user.accountCode || \"\",\r\n        \"Username\": user.username || \"\",\r\n        \"Role\": roleMap[user.role] || \"Unknown\",\r\n        \"Gender\": user.gender !== undefined ? genderMap[user.gender] || \"\" : \"\",\r\n        \"Date of Birth\": user.dateOfBirth ? dayjs(user.dateOfBirth).format(\"YYYY-MM-DD\") : \"\",\r\n        \"Phone Number\": user.phoneNumber || \"\",\r\n        \"Address\": user.address || \"\",\r\n        \"Has Avatar\": user.avatar ? \"Yes\" : \"No\",\r\n      }));\r\n      const ws5 = XLSX.utils.json_to_sheet(usersData);\r\n      XLSX.utils.book_append_sheet(wb, ws5, \"All Users\");\r\n\r\n      const fileName = `Users_Dashboard_${dayjs().format(\"YYYY-MM-DD\")}.xlsx`;\r\n      XLSX.writeFile(wb, fileName);\r\n      message.success(\"All users data exported successfully\");\r\n    } catch (error) {\r\n      console.error(\"Export error:\", error);\r\n      message.error(\"Failed to export users data\");\r\n    } finally {\r\n      setExportLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, []);\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      setUsersLoading(true);\r\n      const { users: usersData } = await adminService.getAccountList(1, 1000);\r\n      setUsers(usersData);\r\n    } catch (error) {\r\n      console.error(\"Error fetching users:\", error);\r\n    } finally {\r\n      setUsersLoading(false);\r\n    }\r\n  };\r\n\r\n  // Filter users based on search, role, and date range\r\n  const filteredUsers = useMemo(() => {\r\n    let filtered = [...users];\r\n\r\n    // Filter by search text\r\n    if (searchText) {\r\n      const searchLower = searchText.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (user) =>\r\n          user.fullName?.toLowerCase().includes(searchLower) ||\r\n          user.email?.toLowerCase().includes(searchLower) ||\r\n          user.accountCode?.toLowerCase().includes(searchLower) ||\r\n          user.username?.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    // Filter by role\r\n    if (selectedRole !== undefined) {\r\n      filtered = filtered.filter((user) => user.role === selectedRole);\r\n    }\r\n\r\n    // Filter by date range - Note: User interface doesn't have createdAt, so we'll skip date filtering for users\r\n    // If you want to filter by dateOfBirth, uncomment below:\r\n    // if (dateRange && dateRange[0] && dateRange[1]) {\r\n    //   filtered = filtered.filter((user) => {\r\n    //     if (!user.dateOfBirth) return false;\r\n    //     const birthDate = dayjs(user.dateOfBirth);\r\n    //     return birthDate.isAfter(dateRange[0]!.subtract(1, \"day\")) && birthDate.isBefore(dateRange[1]!.add(1, \"day\"));\r\n    //   });\r\n    // }\r\n\r\n    return filtered;\r\n  }, [users, searchText, selectedRole, dateRange]);\r\n\r\n  if (!overview) return null;\r\n\r\n  const roleDistribution = [\r\n    { name: \"Admin\", value: overview.users.byRole.admin, color: COLORS.red },\r\n    { name: \"Lecturer\", value: overview.users.byRole.lecturer, color: COLORS.purple },\r\n    { name: \"Student\", value: overview.users.byRole.student, color: COLORS.green },\r\n    { name: \"HOD\", value: overview.users.byRole.hod, color: COLORS.blue },\r\n    { name: \"Examiner\", value: overview.users.byRole.examiner, color: COLORS.orange },\r\n  ];\r\n\r\n  const genderDistribution = [\r\n    { name: \"Male\", value: overview.users.byGender?.male || 0, color: COLORS.blue },\r\n    { name: \"Female\", value: overview.users.byGender?.female || 0, color: \"#FFB6C1\" },\r\n    { name: \"Other\", value: overview.users.byGender?.other || 0, color: COLORS.orange },\r\n  ];\r\n\r\n  const getRoleName = (role: number) => {\r\n    const roles = [\"Admin\", \"Lecturer\", \"Student\", \"HOD\", \"Examiner\"];\r\n    return roles[role] || \"Unknown\";\r\n  };\r\n\r\n  const getRoleColor = (role: number) => {\r\n    const colors = [\"red\", \"purple\", \"green\", \"blue\", \"orange\"];\r\n    return colors[role] || \"default\";\r\n  };\r\n\r\n  const userColumns = [\r\n    {\r\n      title: \"ID\",\r\n      dataIndex: \"id\",\r\n      key: \"id\",\r\n      width: 80,\r\n    },\r\n    {\r\n      title: \"Full Name\",\r\n      dataIndex: \"fullName\",\r\n      key: \"fullName\",\r\n    },\r\n    {\r\n      title: \"Email\",\r\n      dataIndex: \"email\",\r\n      key: \"email\",\r\n    },\r\n    {\r\n      title: \"Role\",\r\n      dataIndex: \"role\",\r\n      key: \"role\",\r\n      render: (role: number) => (\r\n        <Tag color={getRoleColor(role)}>{getRoleName(role)}</Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: \"Account Code\",\r\n      dataIndex: \"accountCode\",\r\n      key: \"accountCode\",\r\n    },\r\n    {\r\n      title: \"Avatar\",\r\n      dataIndex: \"avatar\",\r\n      key: \"avatar\",\r\n      render: (avatar: string) => (\r\n        <Tag color={avatar ? \"green\" : \"default\"}>\r\n          {avatar ? \"Yes\" : \"No\"}\r\n        </Tag>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <Space direction=\"vertical\" size=\"large\" style={{ width: \"100%\" }}>\r\n      {/* Export Button Header */}\r\n      <Card>\r\n        <Space style={{ width: \"100%\", justifyContent: \"space-between\" }}>\r\n          <Title level={4} style={{ margin: 0 }}>Users Dashboard</Title>\r\n          <Button\r\n            icon={<FileExcelOutlined />}\r\n            onClick={handleExportExcel}\r\n            loading={exportLoading}\r\n            type=\"primary\"\r\n            size=\"large\"\r\n          >\r\n            Export All Data to Excel\r\n          </Button>\r\n        </Space>\r\n      </Card>\r\n\r\n      {/* User Statistics Overview */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>User Statistics Overview</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Total Users\"\r\n                value={overview.users.total}\r\n                prefix={<UserOutlined />}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Active Users\"\r\n                value={overview.users.active}\r\n                prefix={<CheckCircleOutlined />}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"New This Month\"\r\n                value={overview.users.newThisMonth}\r\n                prefix={<UserAddOutlined />}\r\n                valueStyle={{ color: COLORS.orange }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Inactive Users\"\r\n                value={overview.users.inactive || 0}\r\n                prefix={<WarningOutlined />}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n        <Row gutter={[16, 16]} style={{ marginTop: 16 }}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"With Avatar\"\r\n                value={overview.users.usersWithAvatar || 0}\r\n                suffix={`/ ${overview.users.total}`}\r\n                valueStyle={{ color: COLORS.cyan }}\r\n              />\r\n              <Progress\r\n                percent={overview.users.total > 0 ? Math.round(((overview.users.usersWithAvatar || 0) / overview.users.total) * 100) : 0}\r\n                size=\"small\"\r\n                style={{ marginTop: 8 }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"With Phone\"\r\n                value={overview.users.usersWithPhone || 0}\r\n                suffix={`/ ${overview.users.total}`}\r\n                valueStyle={{ color: COLORS.purple }}\r\n              />\r\n              <Progress\r\n                percent={overview.users.total > 0 ? Math.round(((overview.users.usersWithPhone || 0) / overview.users.total) * 100) : 0}\r\n                size=\"small\"\r\n                style={{ marginTop: 8 }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Average Age\"\r\n                value={overview.users.averageAge || 0}\r\n                suffix=\"years\"\r\n                valueStyle={{ color: COLORS.orange }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Active Rate\"\r\n                value={overview.users.total > 0 ? Math.round((overview.users.active / overview.users.total) * 100) : 0}\r\n                suffix=\"%\"\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n              <Progress\r\n                percent={overview.users.total > 0 ? Math.round((overview.users.active / overview.users.total) * 100) : 0}\r\n                size=\"small\"\r\n                style={{ marginTop: 8 }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Role Distribution */}\r\n      <Card>\r\n        <Title level={5} style={{ marginBottom: 16 }}>Users by Role</Title>\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Admins\"\r\n                value={overview.users.byRole.admin}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Lecturers\"\r\n                value={overview.users.byRole.lecturer}\r\n                valueStyle={{ color: COLORS.purple }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Students\"\r\n                value={overview.users.byRole.student}\r\n                valueStyle={{ color: COLORS.green }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"HODs\"\r\n                value={overview.users.byRole.hod}\r\n                valueStyle={{ color: COLORS.blue }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Examiners\"\r\n                value={overview.users.byRole.examiner}\r\n                valueStyle={{ color: COLORS.orange }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} lg={6}>\r\n            <Card>\r\n              <Statistic\r\n                title=\"Never Logged In\"\r\n                value={overview.users.neverLoggedIn || 0}\r\n                valueStyle={{ color: COLORS.red }}\r\n              />\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Card>\r\n\r\n      {/* Charts */}\r\n      <Row gutter={[16, 16]}>\r\n        <Col xs={24} lg={8}>\r\n          <Card title=\"Role Distribution\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <PieChart>\r\n                <Pie\r\n                  data={roleDistribution}\r\n                  cx=\"50%\"\r\n                  cy=\"50%\"\r\n                  labelLine={false}\r\n                  label={(entry: any) =>\r\n                    `${entry.name} ${(entry.percent * 100).toFixed(0)}%`\r\n                  }\r\n                  outerRadius={80}\r\n                  fill=\"#8884d8\"\r\n                  dataKey=\"value\"\r\n                >\r\n                  {roleDistribution.map((entry, index) => (\r\n                    <Cell key={`cell-${index}`} fill={entry.color} />\r\n                  ))}\r\n                </Pie>\r\n                <RechartsTooltip />\r\n              </PieChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n\r\n        <Col xs={24} lg={8}>\r\n          <Card title=\"Gender Distribution\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <BarChart data={genderDistribution}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"name\" />\r\n                <YAxis />\r\n                <RechartsTooltip />\r\n                <Bar dataKey=\"value\" fill={COLORS.blue} />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n\r\n        <Col xs={24} lg={8}>\r\n          <Card title=\"User Growth (Last 12 Months)\" loading={loading}>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <BarChart data={chartData?.userGrowth || []}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"month\" />\r\n                <YAxis />\r\n                <RechartsTooltip />\r\n                <Legend />\r\n                <Bar dataKey=\"total\" fill={COLORS.blue} name=\"Total Users\" />\r\n                <Bar dataKey=\"students\" fill={COLORS.green} name=\"Students\" />\r\n                <Bar dataKey=\"lecturers\" fill={COLORS.purple} name=\"Lecturers\" />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Users Table */}\r\n      <Card\r\n        title=\"All Users\"\r\n        loading={usersLoading}\r\n        extra={\r\n          <Space>\r\n            <Select\r\n              placeholder=\"Filter by Role\"\r\n              allowClear\r\n              style={{ width: 150 }}\r\n              value={selectedRole}\r\n              onChange={setSelectedRole}\r\n              suffixIcon={<FilterOutlined />}\r\n            >\r\n              <Select.Option value={0}>Admin</Select.Option>\r\n              <Select.Option value={1}>Lecturer</Select.Option>\r\n              <Select.Option value={2}>Student</Select.Option>\r\n              <Select.Option value={3}>HOD</Select.Option>\r\n              <Select.Option value={4}>Examiner</Select.Option>\r\n            </Select>\r\n            <RangePicker\r\n              placeholder={[\"Start Date\", \"End Date\"]}\r\n              onChange={(dates) => setDateRange(dates as [Dayjs | null, Dayjs | null] | null)}\r\n              style={{ width: 250 }}\r\n            />\r\n          </Space>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: \"100%\", marginBottom: 16 }}>\r\n          <Search\r\n            placeholder=\"Search by name, email, account code, or username\"\r\n            allowClear\r\n            enterButton={<SearchOutlined />}\r\n            size=\"large\"\r\n            value={searchText}\r\n            onChange={(e) => setSearchText(e.target.value)}\r\n            onSearch={setSearchText}\r\n          />\r\n          <Text type=\"secondary\">\r\n            Showing {filteredUsers.length} of {users.length} users\r\n          </Text>\r\n        </Space>\r\n        <Table\r\n          columns={userColumns}\r\n          dataSource={filteredUsers}\r\n          rowKey=\"id\"\r\n          pagination={{ pageSize: 10, showTotal: (total) => `Total ${total} users` }}\r\n          scroll={{ x: 800 }}\r\n        />\r\n      </Card>\r\n    </Space>\r\n  );\r\n};\r\n\r\nexport default UsersTab;\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/app/admin/dashboard/components/UsersTab.tsx b/src/app/admin/dashboard/components/UsersTab.tsx
--- a/src/app/admin/dashboard/components/UsersTab.tsx	(revision 6f9873a8330481f7416524ce2b29e489e3f5c3fa)
+++ b/src/app/admin/dashboard/components/UsersTab.tsx	(date 1763996951142)
@@ -312,37 +312,37 @@
       {/* User Statistics Overview */}
       <Card>
         <Title level={5} style={{ marginBottom: 16 }}>User Statistics Overview</Title>
-        <Row gutter={[16, 16]}>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Total Users"
-                value={overview.users.total}
-                prefix={<UserOutlined />}
-                valueStyle={{ color: COLORS.blue }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Active Users"
-                value={overview.users.active}
-                prefix={<CheckCircleOutlined />}
-                valueStyle={{ color: COLORS.green }}
-              />
-            </Card>
-          </Col>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="New This Month"
-                value={overview.users.newThisMonth}
-                prefix={<UserAddOutlined />}
-                valueStyle={{ color: COLORS.orange }}
-              />
-            </Card>
-          </Col>
+      <Row gutter={[16, 16]}>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Total Users"
+              value={overview.users.total}
+              prefix={<UserOutlined />}
+              valueStyle={{ color: COLORS.blue }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="Active Users"
+              value={overview.users.active}
+              prefix={<CheckCircleOutlined />}
+              valueStyle={{ color: COLORS.green }}
+            />
+          </Card>
+        </Col>
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="New This Month"
+              value={overview.users.newThisMonth}
+              prefix={<UserAddOutlined />}
+              valueStyle={{ color: COLORS.orange }}
+            />
+          </Card>
+        </Col>
           <Col xs={24} sm={12} lg={6}>
             <Card>
               <Statistic
@@ -355,14 +355,14 @@
           </Col>
         </Row>
         <Row gutter={[16, 16]} style={{ marginTop: 16 }}>
-          <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="With Avatar"
-                value={overview.users.usersWithAvatar || 0}
-                suffix={`/ ${overview.users.total}`}
-                valueStyle={{ color: COLORS.cyan }}
-              />
+        <Col xs={24} sm={12} lg={6}>
+          <Card>
+            <Statistic
+              title="With Avatar"
+              value={overview.users.usersWithAvatar || 0}
+              suffix={`/ ${overview.users.total}`}
+              valueStyle={{ color: COLORS.cyan }}
+            />
               <Progress
                 percent={overview.users.total > 0 ? Math.round(((overview.users.usersWithAvatar || 0) / overview.users.total) * 100) : 0}
                 size="small"
@@ -408,70 +408,70 @@
                 size="small"
                 style={{ marginTop: 8 }}
               />
-            </Card>
-          </Col>
-        </Row>
+          </Card>
+        </Col>
+      </Row>
       </Card>
 
       {/* Role Distribution */}
       <Card>
         <Title level={5} style={{ marginBottom: 16 }}>Users by Role</Title>
-        <Row gutter={[16, 16]}>
+      <Row gutter={[16, 16]}>
           <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Admins"
-                value={overview.users.byRole.admin}
-                valueStyle={{ color: COLORS.red }}
-              />
-            </Card>
-          </Col>
+          <Card>
+            <Statistic
+              title="Admins"
+              value={overview.users.byRole.admin}
+              valueStyle={{ color: COLORS.red }}
+            />
+          </Card>
+        </Col>
           <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Lecturers"
-                value={overview.users.byRole.lecturer}
-                valueStyle={{ color: COLORS.purple }}
-              />
-            </Card>
-          </Col>
+          <Card>
+            <Statistic
+              title="Lecturers"
+              value={overview.users.byRole.lecturer}
+              valueStyle={{ color: COLORS.purple }}
+            />
+          </Card>
+        </Col>
           <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Students"
-                value={overview.users.byRole.student}
-                valueStyle={{ color: COLORS.green }}
-              />
-            </Card>
-          </Col>
+          <Card>
+            <Statistic
+              title="Students"
+              value={overview.users.byRole.student}
+              valueStyle={{ color: COLORS.green }}
+            />
+          </Card>
+        </Col>
           <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="HODs"
-                value={overview.users.byRole.hod}
-                valueStyle={{ color: COLORS.blue }}
-              />
-            </Card>
-          </Col>
+          <Card>
+            <Statistic
+              title="HODs"
+              value={overview.users.byRole.hod}
+              valueStyle={{ color: COLORS.blue }}
+            />
+          </Card>
+        </Col>
           <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
-                title="Examiners"
-                value={overview.users.byRole.examiner}
-                valueStyle={{ color: COLORS.orange }}
-              />
-            </Card>
-          </Col>
+          <Card>
+            <Statistic
+              title="Examiners"
+              value={overview.users.byRole.examiner}
+              valueStyle={{ color: COLORS.orange }}
+            />
+          </Card>
+        </Col>
           <Col xs={24} sm={12} lg={6}>
-            <Card>
-              <Statistic
+          <Card>
+            <Statistic
                 title="Never Logged In"
                 value={overview.users.neverLoggedIn || 0}
                 valueStyle={{ color: COLORS.red }}
-              />
-            </Card>
-          </Col>
-        </Row>
+            />
+          </Card>
+        </Col>
+      </Row>
       </Card>
 
       {/* Charts */}
Index: src/app/classes/my-classes/lecturer/page.tsx
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\"use client\";\r\n\r\nimport { useState, useEffect, useMemo } from \"react\";\r\nimport MyCoursesGrid from \"@/components/classes/MyCoursesGrid\";\r\nimport { Layout } from \"@/components/layout/Layout\";\r\nimport { ClassInfo, classService } from \"@/services/classService\";\r\nimport { lecturerService } from \"@/services/lecturerService\";\r\nimport { SimpleCourseCardProps } from \"@/components/classes/SimpleCourseCard\";\r\nimport { useAuth } from \"@/hooks/useAuth\";\r\n\r\nfunction mapApiDataToCardProps(classes: ClassInfo[]): SimpleCourseCardProps[] {\r\n  return classes.map((cls) => ({\r\n    id: cls.id,\r\n    title: cls.courseName || cls.classCode,\r\n    authorName: cls.lecturerName,\r\n    imageUrl: \"/classes/class.png\",\r\n    authorAvatarUrl: \"/classes/avatar-teacher.png\",\r\n    href: `/lecturer/info/${cls.id}`,\r\n  }));\r\n}\r\n\r\nexport default function MyClassesPage() {\r\n  const { user, isLoading: isAuthLoading } = useAuth();\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [allCourses, setAllCourses] = useState<ClassInfo[]>([]);\r\n  const [selectedSemester, setSelectedSemester] = useState<string>(\"all\");\r\n\r\n  useEffect(() => {\r\n    const fetchCourses = async () => {\r\n      if (!user) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        setIsLoading(true);\r\n\r\n        const lecturers = await lecturerService.getLecturerList();\r\n        const currentUserAccountId = String(user.id);\r\n\r\n        const matchingLecturer = lecturers.find(\r\n          (lec) => lec.accountId === currentUserAccountId\r\n        );\r\n\r\n        if (!matchingLecturer) {\r\n          console.error(\"No matching lecturer profile found for account ID.\");\r\n          setAllCourses([]);\r\n          return;\r\n        }\r\n\r\n        const currentLecturerId = parseInt(matchingLecturer.lecturerId, 10);\r\n\r\n        if (isNaN(currentLecturerId)) {\r\n          console.error(\"Invalid lecturer ID.\");\r\n          setAllCourses([]);\r\n          return;\r\n        }\r\n\r\n        const { classes } = await classService.getClassList({\r\n          pageNumber: 1,\r\n          pageSize: 1000,\r\n          lecturerId: currentLecturerId,\r\n        });\r\n\r\n        setAllCourses(classes);\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch courses:\", error);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchCourses();\r\n  }, [user]);\r\n\r\n  const semesterOptions = useMemo(() => {\r\n    const uniqueSemesters = [\r\n      ...new Set(allCourses.map((cls) => cls.semesterName)),\r\n    ];\r\n    const options = uniqueSemesters.map((semester) => ({\r\n      label: semester,\r\n      value: semester,\r\n    }));\r\n    return [{ label: \"All Semesters\", value: \"all\" }, ...options];\r\n  }, [allCourses]);\r\n\r\n  const filteredMappedCourses = useMemo(() => {\r\n    const filtered =\r\n      selectedSemester === \"all\"\r\n        ? allCourses\r\n        : allCourses.filter(\r\n            (cls) => cls.semesterName === selectedSemester\r\n          );\r\n    return mapApiDataToCardProps(filtered);\r\n  }, [allCourses, selectedSemester]);\r\n\r\n  const handleSemesterChange = (value: string) => {\r\n    setSelectedSemester(value);\r\n  };\r\n\r\n  if (isLoading || isAuthLoading) {\r\n    return (\r\n      <Layout>\r\n        <div>Loading...</div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  const userName = user?.fullName || user?.username || \"User\";\r\n\r\n  return (\r\n    <Layout>\r\n      <MyCoursesGrid\r\n        userName={userName}\r\n        courses={filteredMappedCourses}\r\n        semesterOptions={semesterOptions}\r\n        selectedSemester={selectedSemester}\r\n        onSemesterChange={handleSemesterChange}\r\n      />\r\n    </Layout>\r\n  );\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/app/classes/my-classes/lecturer/page.tsx b/src/app/classes/my-classes/lecturer/page.tsx
--- a/src/app/classes/my-classes/lecturer/page.tsx	(revision 6f9873a8330481f7416524ce2b29e489e3f5c3fa)
+++ b/src/app/classes/my-classes/lecturer/page.tsx	(date 1763997609429)
@@ -7,6 +7,7 @@
 import { lecturerService } from "@/services/lecturerService";
 import { SimpleCourseCardProps } from "@/components/classes/SimpleCourseCard";
 import { useAuth } from "@/hooks/useAuth";
+import { adminService } from "@/services/adminService";
 
 function mapApiDataToCardProps(classes: ClassInfo[]): SimpleCourseCardProps[] {
   return classes.map((cls) => ({
@@ -55,13 +56,36 @@
           return;
         }
 
-        const { classes } = await classService.getClassList({
-          pageNumber: 1,
-          pageSize: 1000,
-          lecturerId: currentLecturerId,
-        });
+        const [classesResult, semesters] = await Promise.all([
+          classService.getClassList({
+            pageNumber: 1,
+            pageSize: 1000,
+            lecturerId: currentLecturerId,
+          }),
+          adminService.getPaginatedSemesters(1, 100).catch(() => []),
+        ]);
 
+        const { classes } = classesResult;
         setAllCourses(classes);
+
+        // Find current active semester
+        const now = new Date();
+        const activeSemester = semesters.find(
+          (sem) =>
+            new Date(sem.startDate) <= now && new Date(sem.endDate) >= now
+        );
+
+        // Set default selected semester to current active semester if found
+        if (activeSemester) {
+          // Try to match semesterCode with semesterName in classes
+          const matchingSemesterName = classes.find(
+            (cls) => cls.semesterName === activeSemester.semesterCode
+          )?.semesterName;
+
+          if (matchingSemesterName) {
+            setSelectedSemester(matchingSemesterName);
+          }
+        }
       } catch (error) {
         console.error("Failed to fetch courses:", error);
       } finally {
